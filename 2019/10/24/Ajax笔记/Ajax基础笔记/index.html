<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Ajax基础 | 云海雪原</title><meta name="description" content="Ajax基础"><meta name="keywords" content="Ajax"><meta name="author" content="雪海の无涯"><meta name="copyright" content="雪海の无涯"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="http://wuguolong.com/2019/10/24/Ajax笔记/Ajax基础笔记/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Ajax基础"><meta name="twitter:description" content="Ajax基础"><meta name="twitter:image" content="https://s2.ax1x.com/2019/10/24/KUV0KS.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Ajax基础"><meta property="og:url" content="http://wuguolong.com/2019/10/24/Ajax笔记/Ajax基础笔记/"><meta property="og:site_name" content="云海雪原"><meta property="og:description" content="Ajax基础"><meta property="og:image" content="https://s2.ax1x.com/2019/10/24/KUV0KS.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="git介绍" href="http://wuguolong.com/2019/10/24/Git使用笔记/"><link rel="next" title="Hexo 创建博客" href="http://wuguolong.com/2019/05/26/hexo搭建播客/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://www.wuguolong.com/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: {"languages":{"author":"作者: 雪海の无涯","link":"链接: http://wuguolong.com/2019/10/24/Ajax笔记/Ajax基础笔记/","source":"来源: 云海雪原","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  copy_copyright_js: true
  
}</script></head><body><canvas class="fireworks"></canvas><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">云海雪原</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">29</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">23</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">18</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Ajax技术"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">Ajax技术</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-案例—新用户注册时用户名冲突问题"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">1. 案例—新用户注册时用户名冲突问题</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-传统模式解决方案"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">1.1 传统模式解决方案</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-ajax解决方案"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">1.2 ajax解决方案</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-两种模式对比"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">1.3 两种模式对比</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-ajax快速入门"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">2.ajax快速入门</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-ajax概述"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text">2.1 ajax概述</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-发送Ajax请求"><span class="toc_mobile_items-number">1.2.2.</span> <span class="toc_mobile_items-text">2.2 发送Ajax请求</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-1-ajax核心对象-—-XMLHttpRequest对象"><span class="toc_mobile_items-number">1.2.2.1.</span> <span class="toc_mobile_items-text">2.2.1 ajax核心对象 — XMLHttpRequest对象</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-2-核心方法"><span class="toc_mobile_items-number">1.2.2.2.</span> <span class="toc_mobile_items-text">2.2.2 核心方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-3-发送请求案例"><span class="toc_mobile_items-number">1.2.2.3.</span> <span class="toc_mobile_items-text">2.2.3 发送请求案例</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-3-接收后端响应结果"><span class="toc_mobile_items-number">1.2.3.</span> <span class="toc_mobile_items-text">2.3 接收后端响应结果</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-1-核心属性-—-readyState"><span class="toc_mobile_items-number">1.2.3.1.</span> <span class="toc_mobile_items-text">2.3.1 核心属性 — readyState</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-2-核心事件-—-onreadystatechange"><span class="toc_mobile_items-number">1.2.3.2.</span> <span class="toc_mobile_items-text">2.3.2  核心事件 — onreadystatechange</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-3-其他重要属性"><span class="toc_mobile_items-number">1.2.3.3.</span> <span class="toc_mobile_items-text">2.3.3  其他重要属性</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-4-响应案例-—-index-php"><span class="toc_mobile_items-number">1.2.3.4.</span> <span class="toc_mobile_items-text">2.3.4 响应案例 — index.php</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-4-Ajax程序一般流程"><span class="toc_mobile_items-number">1.2.4.</span> <span class="toc_mobile_items-text">2.4 Ajax程序一般流程</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#两个页面"><span class="toc_mobile_items-number">1.2.4.1.</span> <span class="toc_mobile_items-text">两个页面:</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#三大步骤"><span class="toc_mobile_items-number">1.2.4.2.</span> <span class="toc_mobile_items-text">三大步骤:</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-5-综合案例"><span class="toc_mobile_items-number">1.2.5.</span> <span class="toc_mobile_items-text">2.5 综合案例</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-POST和GET"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">3. POST和GET</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-1-GET方式实现新用户注册—用户名检测"><span class="toc_mobile_items-number">1.3.1.</span> <span class="toc_mobile_items-text">3.1 GET方式实现新用户注册—用户名检测</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-2-POST方式实现新用户注册—用户名检测"><span class="toc_mobile_items-number">1.3.2.</span> <span class="toc_mobile_items-text">3.2 POST方式实现新用户注册—用户名检测</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-GET缓存"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">4. GET缓存</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-1-什么是缓存？"><span class="toc_mobile_items-number">1.4.1.</span> <span class="toc_mobile_items-text">4.1 什么是缓存？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-2-GET缓存测试"><span class="toc_mobile_items-number">1.4.2.</span> <span class="toc_mobile_items-text">4.2 GET缓存测试</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-3-解决方法"><span class="toc_mobile_items-number">1.4.3.</span> <span class="toc_mobile_items-text">4.3 解决方法</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-同步和异步"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">5. 同步和异步</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5-1-同步-异步概念"><span class="toc_mobile_items-number">1.5.1.</span> <span class="toc_mobile_items-text">5.1 同步/异步概念</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5-2-案例"><span class="toc_mobile_items-number">1.5.2.</span> <span class="toc_mobile_items-text">5.2 案例</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-XMLHttpRequest2-0新特性"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">6. XMLHttpRequest2.0新特性</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-timeout-和-ontimeout"><span class="toc_mobile_items-number">1.6.1.</span> <span class="toc_mobile_items-text">2.1 timeout 和 ontimeout</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-问题"><span class="toc_mobile_items-number">1.6.2.</span> <span class="toc_mobile_items-text">2.1 问题</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#7、FormData表单对象"><span class="toc_mobile_items-number">1.7.</span> <span class="toc_mobile_items-text">7、FormData表单对象</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#8、文件上传进度条案例"><span class="toc_mobile_items-number">1.8.</span> <span class="toc_mobile_items-text">8、文件上传进度条案例</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#9、-JSON"><span class="toc_mobile_items-number">1.9.</span> <span class="toc_mobile_items-text">9、 JSON</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-、什么是JSON？"><span class="toc_mobile_items-number">1.9.1.</span> <span class="toc_mobile_items-text">1 、什么是JSON？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2、-JSON数据的声明和使用"><span class="toc_mobile_items-number">1.9.2.</span> <span class="toc_mobile_items-text">2、 JSON数据的声明和使用</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3、PHP中json与对象或数组互转"><span class="toc_mobile_items-number">1.9.3.</span> <span class="toc_mobile_items-text">3、PHP中json与对象或数组互转</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#PHP数组转JSON格式的字符串"><span class="toc_mobile_items-number">1.9.3.1.</span> <span class="toc_mobile_items-text">PHP数组转JSON格式的字符串</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4、JS中json与对象或数组互转"><span class="toc_mobile_items-number">1.9.4.</span> <span class="toc_mobile_items-text">4、JS中json与对象或数组互转</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5、案例-—-搜索用户名，显示用户列表信息"><span class="toc_mobile_items-number">1.9.5.</span> <span class="toc_mobile_items-text">5、案例 — 搜索用户名，显示用户列表信息</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10、jQuery提供的Ajax方法"><span class="toc_mobile_items-number">1.10.</span> <span class="toc_mobile_items-text">10、jQuery提供的Ajax方法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1、-get"><span class="toc_mobile_items-number">1.10.1.</span> <span class="toc_mobile_items-text">1、$.get</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2、-post"><span class="toc_mobile_items-number">1.10.2.</span> <span class="toc_mobile_items-text">2、$.post</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3、案例-—-搜索框下拉列表"><span class="toc_mobile_items-number">1.10.3.</span> <span class="toc_mobile_items-text">3、案例 — 搜索框下拉列表</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4、-ajax"><span class="toc_mobile_items-number">1.10.4.</span> <span class="toc_mobile_items-text">4、$.ajax</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5、-“form”-serialize"><span class="toc_mobile_items-number">1.10.5.</span> <span class="toc_mobile_items-text">5、$(“form”).serialize()</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#11、自己封装Ajax-—-和jQuery一样"><span class="toc_mobile_items-number">1.11.</span> <span class="toc_mobile_items-text">11、自己封装Ajax — 和jQuery一样</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-封装-get方法"><span class="toc_mobile_items-number">1.11.1.</span> <span class="toc_mobile_items-text">2.1 封装 $.get方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-封装-post方法"><span class="toc_mobile_items-number">1.11.2.</span> <span class="toc_mobile_items-text">2.2 封装 $.post方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-3封装-ajax方法"><span class="toc_mobile_items-number">1.11.3.</span> <span class="toc_mobile_items-text">2. 3封装$.ajax方法</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12、模板引擎"><span class="toc_mobile_items-number">1.12.</span> <span class="toc_mobile_items-text">12、模板引擎</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-为什么要使用模板引擎"><span class="toc_mobile_items-number">1.12.1.</span> <span class="toc_mobile_items-text">1.1 为什么要使用模板引擎</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-常见模板引擎"><span class="toc_mobile_items-number">1.12.2.</span> <span class="toc_mobile_items-text">1.2 常见模板引擎</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-artTemplate快速上手"><span class="toc_mobile_items-number">1.12.3.</span> <span class="toc_mobile_items-text">1.3 artTemplate快速上手</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-4-循环结构-—-each"><span class="toc_mobile_items-number">1.12.4.</span> <span class="toc_mobile_items-text">1.4 循环结构 — each</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-5-选择结构-—-if-else"><span class="toc_mobile_items-number">1.12.5.</span> <span class="toc_mobile_items-text">1.5 选择结构 — if else</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-6-使用模板引擎改造搜索用户名案例"><span class="toc_mobile_items-number">1.12.6.</span> <span class="toc_mobile_items-text">1.6 使用模板引擎改造搜索用户名案例</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-7-选项卡案例"><span class="toc_mobile_items-number">1.12.7.</span> <span class="toc_mobile_items-text">1.7 选项卡案例</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-8-模板引擎原理简介-了解"><span class="toc_mobile_items-number">1.12.8.</span> <span class="toc_mobile_items-text">1.8 模板引擎原理简介(了解)</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#13、虚拟主机配置"><span class="toc_mobile_items-number">1.13.</span> <span class="toc_mobile_items-text">13、虚拟主机配置</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-1-什么是虚拟主机"><span class="toc_mobile_items-number">1.13.1.</span> <span class="toc_mobile_items-text">3.1 什么是虚拟主机</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-2-虚拟主机配置3步骤"><span class="toc_mobile_items-number">1.13.2.</span> <span class="toc_mobile_items-text">3.2 虚拟主机配置3步骤</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4、-ajax跨域"><span class="toc_mobile_items-number">1.14.</span> <span class="toc_mobile_items-text">4、 ajax跨域</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-1-什么是ajax跨域"><span class="toc_mobile_items-number">1.14.1.</span> <span class="toc_mobile_items-text">4.1 什么是ajax跨域</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-2-代理实现ajax跨域"><span class="toc_mobile_items-number">1.14.2.</span> <span class="toc_mobile_items-text">4.2 代理实现ajax跨域</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#file-get-contents-url"><span class="toc_mobile_items-number">1.14.2.1.</span> <span class="toc_mobile_items-text">file_get_contents(url)</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-3-cors跨域"><span class="toc_mobile_items-number">1.14.3.</span> <span class="toc_mobile_items-text">4.3 cors跨域</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#header-‘Access-Control-Allow-origin-url-’"><span class="toc_mobile_items-number">1.14.3.1.</span> <span class="toc_mobile_items-text">header(‘Access-Control-Allow-origin: url || *’)</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-4-jsonp跨域"><span class="toc_mobile_items-number">1.14.4.</span> <span class="toc_mobile_items-text">4.4 jsonp跨域</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-5-ajax方法跨域操作-—-jsonp方式"><span class="toc_mobile_items-number">1.14.5.</span> <span class="toc_mobile_items-text">4.5 $.ajax方法跨域操作 — jsonp方式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-6-调用网上接口-—-天气预报"><span class="toc_mobile_items-number">1.14.6.</span> <span class="toc_mobile_items-text">4.6 调用网上接口 — 天气预报</span></a></li></ol></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Ajax技术"><span class="toc-number">1.</span> <span class="toc-text">Ajax技术</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-案例—新用户注册时用户名冲突问题"><span class="toc-number">1.1.</span> <span class="toc-text">1. 案例—新用户注册时用户名冲突问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-传统模式解决方案"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 传统模式解决方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-ajax解决方案"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 ajax解决方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-两种模式对比"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 两种模式对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-ajax快速入门"><span class="toc-number">1.2.</span> <span class="toc-text">2.ajax快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-ajax概述"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 ajax概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-发送Ajax请求"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 发送Ajax请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-ajax核心对象-—-XMLHttpRequest对象"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">2.2.1 ajax核心对象 — XMLHttpRequest对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-核心方法"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.2.2 核心方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-发送请求案例"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">2.2.3 发送请求案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-接收后端响应结果"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 接收后端响应结果</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-核心属性-—-readyState"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">2.3.1 核心属性 — readyState</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-核心事件-—-onreadystatechange"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2.3.2  核心事件 — onreadystatechange</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-其他重要属性"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">2.3.3  其他重要属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-响应案例-—-index-php"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">2.3.4 响应案例 — index.php</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Ajax程序一般流程"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 Ajax程序一般流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#两个页面"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">两个页面:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#三大步骤"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">三大步骤:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-综合案例"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5 综合案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-POST和GET"><span class="toc-number">1.3.</span> <span class="toc-text">3. POST和GET</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-GET方式实现新用户注册—用户名检测"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 GET方式实现新用户注册—用户名检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-POST方式实现新用户注册—用户名检测"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 POST方式实现新用户注册—用户名检测</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-GET缓存"><span class="toc-number">1.4.</span> <span class="toc-text">4. GET缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-什么是缓存？"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 什么是缓存？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-GET缓存测试"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 GET缓存测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-解决方法"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 解决方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-同步和异步"><span class="toc-number">1.5.</span> <span class="toc-text">5. 同步和异步</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-同步-异步概念"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 同步/异步概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-案例"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-XMLHttpRequest2-0新特性"><span class="toc-number">1.6.</span> <span class="toc-text">6. XMLHttpRequest2.0新特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-timeout-和-ontimeout"><span class="toc-number">1.6.1.</span> <span class="toc-text">2.1 timeout 和 ontimeout</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-问题"><span class="toc-number">1.6.2.</span> <span class="toc-text">2.1 问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7、FormData表单对象"><span class="toc-number">1.7.</span> <span class="toc-text">7、FormData表单对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8、文件上传进度条案例"><span class="toc-number">1.8.</span> <span class="toc-text">8、文件上传进度条案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9、-JSON"><span class="toc-number">1.9.</span> <span class="toc-text">9、 JSON</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-、什么是JSON？"><span class="toc-number">1.9.1.</span> <span class="toc-text">1 、什么是JSON？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、-JSON数据的声明和使用"><span class="toc-number">1.9.2.</span> <span class="toc-text">2、 JSON数据的声明和使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、PHP中json与对象或数组互转"><span class="toc-number">1.9.3.</span> <span class="toc-text">3、PHP中json与对象或数组互转</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP数组转JSON格式的字符串"><span class="toc-number">1.9.3.1.</span> <span class="toc-text">PHP数组转JSON格式的字符串</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、JS中json与对象或数组互转"><span class="toc-number">1.9.4.</span> <span class="toc-text">4、JS中json与对象或数组互转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、案例-—-搜索用户名，显示用户列表信息"><span class="toc-number">1.9.5.</span> <span class="toc-text">5、案例 — 搜索用户名，显示用户列表信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10、jQuery提供的Ajax方法"><span class="toc-number">1.10.</span> <span class="toc-text">10、jQuery提供的Ajax方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、-get"><span class="toc-number">1.10.1.</span> <span class="toc-text">1、$.get</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、-post"><span class="toc-number">1.10.2.</span> <span class="toc-text">2、$.post</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、案例-—-搜索框下拉列表"><span class="toc-number">1.10.3.</span> <span class="toc-text">3、案例 — 搜索框下拉列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、-ajax"><span class="toc-number">1.10.4.</span> <span class="toc-text">4、$.ajax</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、-“form”-serialize"><span class="toc-number">1.10.5.</span> <span class="toc-text">5、$(“form”).serialize()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11、自己封装Ajax-—-和jQuery一样"><span class="toc-number">1.11.</span> <span class="toc-text">11、自己封装Ajax — 和jQuery一样</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-封装-get方法"><span class="toc-number">1.11.1.</span> <span class="toc-text">2.1 封装 $.get方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-封装-post方法"><span class="toc-number">1.11.2.</span> <span class="toc-text">2.2 封装 $.post方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3封装-ajax方法"><span class="toc-number">1.11.3.</span> <span class="toc-text">2. 3封装$.ajax方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12、模板引擎"><span class="toc-number">1.12.</span> <span class="toc-text">12、模板引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-为什么要使用模板引擎"><span class="toc-number">1.12.1.</span> <span class="toc-text">1.1 为什么要使用模板引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-常见模板引擎"><span class="toc-number">1.12.2.</span> <span class="toc-text">1.2 常见模板引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-artTemplate快速上手"><span class="toc-number">1.12.3.</span> <span class="toc-text">1.3 artTemplate快速上手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-循环结构-—-each"><span class="toc-number">1.12.4.</span> <span class="toc-text">1.4 循环结构 — each</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-选择结构-—-if-else"><span class="toc-number">1.12.5.</span> <span class="toc-text">1.5 选择结构 — if else</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-使用模板引擎改造搜索用户名案例"><span class="toc-number">1.12.6.</span> <span class="toc-text">1.6 使用模板引擎改造搜索用户名案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-选项卡案例"><span class="toc-number">1.12.7.</span> <span class="toc-text">1.7 选项卡案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-8-模板引擎原理简介-了解"><span class="toc-number">1.12.8.</span> <span class="toc-text">1.8 模板引擎原理简介(了解)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13、虚拟主机配置"><span class="toc-number">1.13.</span> <span class="toc-text">13、虚拟主机配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-什么是虚拟主机"><span class="toc-number">1.13.1.</span> <span class="toc-text">3.1 什么是虚拟主机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-虚拟主机配置3步骤"><span class="toc-number">1.13.2.</span> <span class="toc-text">3.2 虚拟主机配置3步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、-ajax跨域"><span class="toc-number">1.14.</span> <span class="toc-text">4、 ajax跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-什么是ajax跨域"><span class="toc-number">1.14.1.</span> <span class="toc-text">4.1 什么是ajax跨域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-代理实现ajax跨域"><span class="toc-number">1.14.2.</span> <span class="toc-text">4.2 代理实现ajax跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#file-get-contents-url"><span class="toc-number">1.14.2.1.</span> <span class="toc-text">file_get_contents(url)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-cors跨域"><span class="toc-number">1.14.3.</span> <span class="toc-text">4.3 cors跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#header-‘Access-Control-Allow-origin-url-’"><span class="toc-number">1.14.3.1.</span> <span class="toc-text">header(‘Access-Control-Allow-origin: url || *’)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-jsonp跨域"><span class="toc-number">1.14.4.</span> <span class="toc-text">4.4 jsonp跨域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-ajax方法跨域操作-—-jsonp方式"><span class="toc-number">1.14.5.</span> <span class="toc-text">4.5 $.ajax方法跨域操作 — jsonp方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-调用网上接口-—-天气预报"><span class="toc-number">1.14.6.</span> <span class="toc-text">4.6 调用网上接口 — 天气预报</span></a></li></ol></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://s2.ax1x.com/2019/10/24/KUV0KS.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">Ajax基础</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-10-24<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-10-24</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Ajax/">Ajax</a></span><div class="post-meta-wordcount"><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="Ajax技术"><a href="#Ajax技术" class="headerlink" title="Ajax技术"></a>Ajax技术</h1><p>每日目标：</p>
<ul>
<li>了解什么是Ajax</li>
<li>掌握创建XMLHttpRequest对象的方法</li>
<li>能够发送Ajax请求并接收到后端返回的数据</li>
<li>掌握POST请求和GET请求的区别</li>
<li>理解什么是GET缓存并解决缓存问题<a id="more"></a>
</li>
</ul>
<h2 id="1-案例—新用户注册时用户名冲突问题"><a href="#1-案例—新用户注册时用户名冲突问题" class="headerlink" title="1. 案例—新用户注册时用户名冲突问题"></a>1. 案例—新用户注册时用户名冲突问题</h2><h3 id="1-1-传统模式解决方案"><a href="#1-1-传统模式解决方案" class="headerlink" title="1.1 传统模式解决方案"></a>1.1 传统模式解决方案</h3><p>1) 在注册页面中输入用户名和密码，点击“注册”时，要将表单数据提交给后台</p>
<p><img alt="d1523691565801" data-src="assets/1.png" class="lozad"></p>
<p>2) 后台PHP页面，接收用户名和密码之后，要去验证用户名是否存在，如果存在则提示用户名存在，再跳转回注册页面，重新输入。</p>
<p>  当用户名存在时，提示用户名已被占用，再跳转回登录页</p>
<p><img alt="1523691637131" data-src="assets/2.png" class="lozad"></p>
<p> 当用户名不存在时，正常注册新用户</p>
<p><img alt="1523691696235" data-src="assets/3.png" class="lozad"></p>
<h3 id="1-2-ajax解决方案"><a href="#1-2-ajax解决方案" class="headerlink" title="1.2 ajax解决方案"></a>1.2 ajax解决方案</h3><p>当光标离开用户名文本框时，就已经验证了用户名是否存在，并给予提示了。</p>
<p>  用户名被占用： </p>
<p><img alt="1523691892998" data-src="assets/4.png" class="lozad"></p>
<p>  用户名可用 :</p>
<p><img alt="1523691866761" data-src="assets/5.png" class="lozad"></p>
<h3 id="1-3-两种模式对比"><a href="#1-3-两种模式对比" class="headerlink" title="1.3 两种模式对比"></a>1.3 两种模式对比</h3><p> 传统模式： </p>
<p>  两个页面 —  前端注册表单页（index.html）  和  后端数据验证页（index.php）</p>
<p> <img alt="1524655686232" data-src="assets/6.png" class="lozad"></p>
<p> Ajax模式 :</p>
<p>  两个页面 — 前端注册表单页（index.html）  和  后端数据验证页（index.php）</p>
<p><img alt="1524656343611" data-src="assets/7.png" class="lozad"></p>
<p>  Ajax的优势：</p>
<pre><code>ajax就是在页面没有刷新或者没有跳转的情况下还能更新页面的某一部分数据
</code></pre><h2 id="2-ajax快速入门"><a href="#2-ajax快速入门" class="headerlink" title="2.ajax快速入门"></a>2.ajax快速入门</h2><h3 id="2-1-ajax概述"><a href="#2-1-ajax概述" class="headerlink" title="2.1 ajax概述"></a>2.1 ajax概述</h3><ul>
<li><p>Ajax:  Asynchronous  javascript  and  xml (异步javascript和xml)。</p>
</li>
<li><p><strong>Ajax并不是一种新技术，而是已有技术的集合。JavaScript是核心载体</strong>。</p>
</li>
<li>Ajax优势：在不刷新页面的情况下，更新页面数据，提升用户体验。</li>
<li><strong>Ajax就像一个小秘书</strong>，能够实现<strong>异步工作</strong>。</li>
</ul>
<h3 id="2-2-发送Ajax请求"><a href="#2-2-发送Ajax请求" class="headerlink" title="2.2 发送Ajax请求"></a>2.2 发送Ajax请求</h3><h4 id="2-2-1-ajax核心对象-—-XMLHttpRequest对象"><a href="#2-2-1-ajax核心对象-—-XMLHttpRequest对象" class="headerlink" title="2.2.1 ajax核心对象 — XMLHttpRequest对象"></a>2.2.1 ajax核心对象 — XMLHttpRequest对象</h4><p>  历史：<br>    1999年诞生，微软在IE5中集成了XMLHttpRequest对象，但是并没有受到人们重视。<br>    2005年，google在gtalk即时聊天工具中使用了该对象，从此之后Ajax技术开始受到人们的重视</p>
<p>  创建XMLHTTPRequest对象要分为(低版本) IE和<strong>非IE两种方式(主流)</strong>：</p>
<p>   IE浏览器（IE7之前） :  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Msxml2.XMLHTTP'</span>);</span><br></pre></td></tr></table></figure>
<p>   非IE浏览器（chrome、firefox、safair、搜狗等，包括IE7+之后） (主流浏览器):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br></pre></td></tr></table></figure>
<p>前端向后台发送请求有几种方式？*</p>
<blockquote>
<p>1、 link标签的href属性</p>
<p>2、 script标签的src属性</p>
<p>3、 img标签的src属性</p>
<p>4、 ajax发送请求</p>
<p>5、 表单提交发送请求</p>
<p>6、 a标签的href发送请求</p>
<p>7、 iframe的src属性发送请求</p>
</blockquote>
<p>案例：创建XMLhttpRequest对象，兼容IE7之前和主流浏览器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建XMLHttpRequest对象，兼容低版本IE和非IE浏览器</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getXhr</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xmlhttp;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">        <span class="comment">//IE7+ 和 非IE 中都有 XMLHttpRequest对象</span></span><br><span class="line">        xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="comment">//低版本IE浏览器 实例化方式</span></span><br><span class="line">        xmlhttp = <span class="keyword">new</span> ActiveXObject(<span class="string">'Msxml2.XMLHTTP'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> xmlhttp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-2-2-核心方法"><a href="#2-2-2-核心方法" class="headerlink" title="2.2.2 核心方法"></a>2.2.2 核心方法</h4><p>XMLHttpRequest</p>
<p>   XMLHttpRequest对象有了，可以发送Ajax请求了。发送请求需要两个方法:</p>
<p>   open(var1, var2, var3): 准备Ajax请求<br>     var1: 请求方式  get/post<br>     var2: 请求的后端程序地址<br>     var3: 异步(true)/同步(false)，可选参数，默认为true</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(<span class="string">'post'</span>, <span class="string">'./uploadfile.php'</span>);</span><br></pre></td></tr></table></figure>
<p>   示例: xhr.open(‘get’, ‘index.php’);   //准备以get方式请求后端的index.php文件</p>
<p>  send(var): 发送Ajax请求<br>     var: 分为两种情况。 如果是get请求，则填写null。 如果是post请求，则填写要发送到后端的数据。</p>
<p>   示例: xhr.send(null); </p>
<h4 id="2-2-3-发送请求案例"><a href="#2-2-3-发送请求案例" class="headerlink" title="2.2.3 发送请求案例"></a>2.2.3 发送请求案例</h4><p> 在index.html页面上创建按钮，点击该按钮时使用get方式请求后端的index.php页面</p>
<p> 发送Ajax请求流程:</p>
<p>   1) 创建XMLHttpRequest对象</p>
<p>   2) 调用open方法准备ajax请求</p>
<p>   3) 调用send方法发送ajax请求</p>
<p> 代码实现</p>
<p>   1) 创建按钮，绑定点击事件</p>
<p>   2) 创建XMLHttpRequest对象</p>
<p>   3) 调用open方法准备ajax请求</p>
<p>   4) 调用send方法发送ajax请求</p>
<p><img alt="1540627720271" data-src="assets/1540627720271.png" class="lozad"></p>
<p><img alt="1540627731126" data-src="assets/1540627731126.png" class="lozad"></p>
<p>访问结果:</p>
<p><img alt="1540627756719" data-src="assets/1540627756719.png" class="lozad"></p>
<h3 id="2-3-接收后端响应结果"><a href="#2-3-接收后端响应结果" class="headerlink" title="2.3 接收后端响应结果"></a>2.3 接收后端响应结果</h3><h4 id="2-3-1-核心属性-—-readyState"><a href="#2-3-1-核心属性-—-readyState" class="headerlink" title="2.3.1 核心属性 — readyState"></a>2.3.1 核心属性 — readyState</h4><ul>
<li>jQuery的$.ajax方法响应数据类型有如下几种：xml、html、script、json、jsonp、text </li>
<li>本质上原生ajax响应数据格式只有2种：<strong>xml</strong>和<strong>text</strong>，分别对应<strong>xhr.responseText</strong>和<strong>xhr.responseXML</strong> </li>
<li><p>Ajax的整个过程有5个状态，对应readyState的5个值：0-4</p>
<p>  《Pragmatic Ajax A Web 2.0 Primer 》 中对readyStae状态的介绍 </p>
<p> 0: (Uninitialized) the send( ) method has not yet been invoked.  </p>
<p> 1: (Loading) the send( ) method has been invoked, request in progress.  </p>
<p> 2: (Loaded) the send( ) method has completed, entire response received. </p>
<p> 3: (Interactive) the response is being parsed. </p>
<p> 4: (Completed) the response has been parsed, is ready for harvesting.  </p>
<p> 0 － （未初始化）还没有调用send()方法 </p>
<p> 1 － （载入）已调用send()方法，正在发送请求 </p>
<p> 2 － （载入完成）send()方法执行完成，已经接收到全部响应内容 </p>
<p> 3 － （交互）正在解析响应内容 </p>
<p> 4 － （完成）响应内容解析完成，可以在客户端调用了 </p>
</li>
</ul>
<p>百度百科: </p>
<p>  0 （未初始化）     对象已建立，但是尚未初始化（尚未调用open方法）<br>  1 （初始化）      已调用send()方法，正在发送请求<br>  2 （发送数据）     send方法调用完成，但是当前的状态及http头未知<br>  3 （数据传送中）  已接收部分数据，因为响应及http头不全，这时通过responseBody和responseText获取部分数据会出现错误，<br>  4 （完成）       数据接收完毕，此时可以通过通过responseBody和responseText获取完整的回应数据</p>
<p><strong>最核心的重点：   4 ,  后端返回的数据已经可以在浏览器中使用了。</strong></p>
<h4 id="2-3-2-核心事件-—-onreadystatechange"><a href="#2-3-2-核心事件-—-onreadystatechange" class="headerlink" title="2.3.2  核心事件 — onreadystatechange"></a>2.3.2  核心事件 — onreadystatechange</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">onreadystatechange事件:  readyState的值每次发生变化都会触发该事件。</span><br><span class="line">    <span class="number">0</span>--&gt;<span class="number">1</span>    <span class="number">1</span>--&gt;<span class="number">2</span>    <span class="number">2</span>--&gt;<span class="number">3</span>    <span class="number">3</span>--&gt;<span class="number">4</span> 总共触发<span class="number">4</span>次</span><br></pre></td></tr></table></figure>
<h4 id="2-3-3-其他重要属性"><a href="#2-3-3-其他重要属性" class="headerlink" title="2.3.3  其他重要属性"></a>2.3.3  其他重要属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">responseText：以字符串形式接收后端程序的返回值。</span><br><span class="line"></span><br><span class="line">以PHP为例: PHP程序最终会被解释程序一段字符串，responseText接收的就是这段字符串</span><br><span class="line"></span><br><span class="line">responseXML：以XML格式接收后端程序返回值</span><br></pre></td></tr></table></figure>
<h4 id="2-3-4-响应案例-—-index-php"><a href="#2-3-4-响应案例-—-index-php" class="headerlink" title="2.3.4 响应案例 — index.php"></a>2.3.4 响应案例 — index.php</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index.php：返回字符串“Hello Ajax”给前端 --- 就是  echo <span class="string">"Hello Ajax"</span></span><br><span class="line"></span><br><span class="line">index.html： 将Hello Wrold 显示在页面的div中</span><br></pre></td></tr></table></figure>
<p> 1) index.php 返回一个字符串（Hello Ajax！！）</p>
<p> 2) 在index.html中检测readyState的状态，当readyState状态等于4的时候，使用responseText来接收后端返回的数据</p>
<p> <img alt="1540629500695" data-src="assets/1540629500695.png" class="lozad"></p>
<p>responseText本质是接收后端返回的字符串。</p>
<h3 id="2-4-Ajax程序一般流程"><a href="#2-4-Ajax程序一般流程" class="headerlink" title="2.4 Ajax程序一般流程"></a>2.4 Ajax程序一般流程</h3><p>  一般我们编写Ajax程序时需要两个页面，三大步骤:</p>
<p><img alt="1525944330962" data-src="assets/8.png" class="lozad"></p>
<h4 id="两个页面"><a href="#两个页面" class="headerlink" title="两个页面:"></a>两个页面:</h4><p>   前端静态html页面 (php页面也行)，用来发送ajax请求，将结果渲染到页面上</p>
<p>   后端php页面 (jsp、asp也行)，用来接收前端请求，处理数据，并将结果返回给前端页面</p>
<p>   jsp: Java Server Page</p>
<p>   asp: Active Server Page</p>
<h4 id="三大步骤"><a href="#三大步骤" class="headerlink" title="三大步骤:"></a>三大步骤:</h4><p>  1) 前端静态页面发送ajax请求。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、创建 XMLHttpRequest 对象</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、调用open方法准备ajax请求</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、调用send方法发送ajax请求</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、调用onreadystatechange事件，判断readyState=<span class="number">4</span>时，使用responseText接收后端返回数据</span><br></pre></td></tr></table></figure>
<p>  2) 后端php页面，处理请求并返回结果</p>
<p>  3) 前端页面接收结果，显示在网页指定位置</p>
<h3 id="2-5-综合案例"><a href="#2-5-综合案例" class="headerlink" title="2.5 综合案例"></a>2.5 综合案例</h3><p> 点击按钮，从student表中随机取出一条学生信息，显示在网页上。</p>
<p> 思路分析:<br> 1) 两个页面<br>   前端静态页面: student/index.html<br>   后端php页面: student/index.php</p>
<p> <img alt="1524658135608" data-src="assets/9.png" class="lozad"></p>
<p>2) 三大步骤<br>① index.html 页面设置一个按钮，用来触发ajax请求<br>② index.php 随机取出一条学生数据，并返回给index.html页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;select * from student order by rand() limit 0,1&quot;;</span><br><span class="line">// 随机排序  order by rand()</span><br><span class="line">// 条件约束只从表第o位取一行信息</span><br></pre></td></tr></table></figure>
<p>③ index.html 接收到后显示在页面上</p>
<p> 代码实现:</p>
<p>① index.html 页面设置一个按钮，用来触发ajax请求</p>
<p><img alt="1540630350837" data-src="assets/1540630350837.png" class="lozad"></p>
<p>② index.php 随机取出一条学生数据，并返回给index.html页面</p>
<p><img alt="1540630888943" data-src="assets/1540630888943.png" class="lozad"></p>
<p>③ index.html 接收到后显示在页面上</p>
<p><img alt="1540631075947" data-src="assets/1540631075947.png" class="lozad"></p>
<p> 关键点总结:</p>
<p>1) index.html 通过点击事件发送ajax请求<br> ① 创建XMLHttpRequest对象<br> ② 调用open方法准备ajax请求<br> ③ 调用send方法发送ajax请求</p>
<p><strong>此时不要着急将数据渲染到网页上</strong>。</p>
<p> 2) index.php 随机取出一条学生数据，并返回给index.html页面<br>  ① mysqli操作MySQL服务器的6步骤<br>  ② 核心SQL:  select * from student order by rand() limit 0,1<br>  ③ 将结果拼接成字符串再输出，因为前端是以字符串形式接收的</p>
<p> 3) index.html接收到后显示在页面上<br>  ① 创建一个div标签，用来显示接收到数据<br>  ② 获取div对象，再将数据显示到该标签中</p>
<h2 id="3-POST和GET"><a href="#3-POST和GET" class="headerlink" title="3. POST和GET"></a>3. POST和GET</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a标签   location.href   header(<span class="string">'refresh:2;url=eidt.php?sno='</span> . $sno);</span><br></pre></td></tr></table></figure>
<h3 id="3-1-GET方式实现新用户注册—用户名检测"><a href="#3-1-GET方式实现新用户注册—用户名检测" class="headerlink" title="3.1 GET方式实现新用户注册—用户名检测"></a>3.1 GET方式实现新用户注册—用户名检测</h3><p> 思路分析:</p>
<p><img alt="1523697737792" data-src="assets/10.png" class="lozad"></p>
<p> 步骤:</p>
<ol>
<li><p>get.html</p>
<p>1) 在用户名文本框上绑定失焦事件(onblur)<br>2) 失焦事件函数</p>
<pre><code>① 获取用户名文本框内已填写的用户名
</code></pre><p>​          ② 发送ajax请求，并将已填写的用户名一起发送给后端php页面</p>
</li>
</ol>
<ol start="2">
<li><p>get.php</p>
<p> 1) 接收前端发送过来的用户名<br> 2) 拼接SQL语句<br> 3) 链接MySQL服务器并执行SQL语句 –&gt;  空(0条数据，用户名可用)   一维数组(1条数据，用户名被占用)<br> 4) 将结果返回给前端。 返回1 或者 2</p>
</li>
</ol>
<ol start="3">
<li><p>get.html</p>
<p> 接收后端返回的数据，判断是1还是2。</p>
<p> 如果等于1，则提示用户名可用；如果等于2，提示用户名被占用</p>
</li>
</ol>
<p>代码实现:</p>
<ol>
<li><p>get.html</p>
<p>1) 在用户名文本框上绑定失焦事件(onblur)<br>2) 失焦事件函数</p>
<pre><code>① 获取用户名文本框内已填写的用户名
② 发送ajax请求，并将已填写的用户名一起发送给后端php页面
</code></pre></li>
</ol>
<p><img alt="1540632380234" data-src="assets/1540632380234.png" class="lozad"></p>
<ol start="2">
<li><p>get.php</p>
<p>1) 接收前端发送过来的用户名<br>2) 模拟用户被占用的情况<br>3) 将结果返回给前端（1用户名可用   2用户名被占用）</p>
</li>
</ol>
<p><img alt="1540633467282" data-src="assets/1540633467282.png" class="lozad"></p>
<ol start="3">
<li><p>get.html</p>
<p> 1) 接收后端返回的数据，判断是1还是2。</p>
<p> 2) 如果等于1，则提示用户名可用；如果等于2，提示用户名被占用</p>
</li>
</ol>
<p><img alt="1540633813263" data-src="assets/1540633813263.png" class="lozad"></p>
<p>关键点总结:</p>
<ol>
<li><p>用户名文本框绑定失焦事件</p>
</li>
<li><p>发送ajax请求基本属于流程化操作</p>
<p>1) 实例化XMLHttpRequest对象<br>2) 调用open方法准备请求，<strong>get方式发送将数据拼接在url地址之后即可</strong></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3) 调用send方法发送请求，**get方式只需要将 null  作为参数传入即可**</span><br><span class="line">4) 调用onreadystatechange事件，在readyState=4时使用responseText接收返回值。此步使用alert或者console.log先输出接收的结果即可，**不要着急将结果显示在网页上**。</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建后端php程序，接收用户名进行验证</p>
<p>核心SQL:  select * from ali_admin where admin_email = ‘$name’;</p>
<p>该SQL语句的执行结果只可能是两种： 0条数据    1条数据(因为admin_email字段唯一)</p>
<p>  0条数据: 说明没有该用户名 （没有被占用）</p>
<p>  1条数据: 说明已存在该用户名 （已被占用）</p>
<p>根据SQL执行结果返回1或者2，1代表未被占用，2代表已被占用</p>
</li>
<li><p>修改get.html文件，将结果显示在网页上</p>
<p> 获取用来显示结果的span标签，判断接收的结果为1还是2。如果为1，则将用户名可用写入span标签；反之，则将用户名已被占用写入span标签</p>
</li>
</ol>
<h3 id="3-2-POST方式实现新用户注册—用户名检测"><a href="#3-2-POST方式实现新用户注册—用户名检测" class="headerlink" title="3.2 POST方式实现新用户注册—用户名检测"></a>3.2 POST方式实现新用户注册—用户名检测</h3><p>post和get两种方式的整体思路一致，只是细节上有所差别</p>
<p> 1) 使用open准备请求时，参数1需要设置为post，参数2只需要设置后端程序地址。<br> 2) 将需要传递到后端的数据拼接成一个独立的字符串，字符串的格式为<br> <strong>var str = ‘key=value&amp;key=value&amp;….’;</strong>    （内部结构跟get传参时的结构一致）</p>
<p> 3) 调用setRequestHeader方法将数据格式转为 application/x-www-form-urlencoded<br> 4) 将拼接好的数据字符串作为参数传入send方法<br> 5) 后端的php程序需要使用 $_POST来接收数据</p>
<p>get和post的区别:</p>
<p><img alt="1540634863140" data-src="assets/1540634863140.png" class="lozad"></p>
<p><img alt="1540634874736" data-src="assets/1540634874736.png" class="lozad"></p>
<p>关键点总结:<br> 1) 发送程序时，参数1设置为post，参数2只用设置请求的后端文件路径<br>​    xhr.open(‘post’, ‘post.php’);<br> 2) 将需要传递到后端的数据拼接成一个独立的字符串<br>​    var str = ‘name=’+name;<br> 3) 调用setRequestHeader方法将数据格式转为 application/x-www-form-urlencoded<br>​    xhr.setRequestHeader(‘content-type’, ‘application/x-www-form-urlencoded’);<br> 4) 发送请求时，要将之前拼接好的字符串作为参数放入send方法中<br>​    xhr.send(str);</p>
<h2 id="4-GET缓存"><a href="#4-GET缓存" class="headerlink" title="4. GET缓存"></a>4. GET缓存</h2><h3 id="4-1-什么是缓存？"><a href="#4-1-什么是缓存？" class="headerlink" title="4.1 什么是缓存？"></a>4.1 什么是缓存？</h3><p>   浏览器的请求需要从服务器获得许多 css、img、js 等相关的文件，如果每次请求都把相关的资源文件加载一次，对 带宽、服务器资源、用户等待时间 都有严重的损耗。如果浏览器将css、img、js等文件在第一次请求成功后就保存在本机上，以后的每次请求就在本机获得相关的资源文件，那么就可以明显地加快用户的访问速度，同时可以节省各种资源(带宽、服务器资源、用户等待时间)。</p>
<h3 id="4-2-GET缓存测试"><a href="#4-2-GET缓存测试" class="headerlink" title="4.2 GET缓存测试"></a>4.2 GET缓存测试</h3><p> ajax方式，get会有缓存问题。post没有缓存问题</p>
<p> 案例:<br>   index.html页面中创建一个按钮，点击该按钮时发送ajax请求，得到后端php程序返回的当前时间戳并显示。</p>
<ol>
<li>index.html</li>
</ol>
<p><img alt="1540635461920" data-src="assets/1540635461920.png" class="lozad"></p>
<ol start="2">
<li><p>getTime.php — 输出当前时间戳即可。</p>
<p><img alt="1540635472765" data-src="assets/1540635472765.png" class="lozad"></p>
</li>
</ol>
<p>使用IE访问结果:</p>
<p>  <img alt="1540635489053" data-src="assets/1540635489053.png" class="lozad"></p>
<p>永远弹出的都是一个时间戳，说明已经被缓存了。</p>
<h3 id="4-3-解决方法"><a href="#4-3-解决方法" class="headerlink" title="4.3 解决方法"></a>4.3 解决方法</h3><p> 解决方法有两种:<br>  1) 前端方案:  在open准备ajax请求时，为请求的地址增加随机后缀。相当于每次请求都是新的地址</p>
<p>  2) 后端方案:  后端程序设置不允许缓存的头信息，php程序固定使用如下3句即可。<br>    header(‘cache-controller:no-cache’);<br>    header(‘Pragam:no-cache’);<br>    header(‘Expires:-1’);</p>
<p>1) 前端方案:</p>
<p>​     随机后缀一般是 随机数或者时间戳</p>
<p><img alt="1540635704330" data-src="assets/1540635704330.png" class="lozad"></p>
<p>2) 后端解决方案:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">'cache-controller:no-cache'</span>);</span><br><span class="line">header(<span class="string">'Pragam:no-cache'</span>);</span><br><span class="line">header(<span class="string">'Expires:-1'</span>);</span><br></pre></td></tr></table></figure>
<p><img alt="1540635843908" data-src="assets/1540635843908.png" class="lozad"></p>
<p>​    </p>
<h2 id="5-同步和异步"><a href="#5-同步和异步" class="headerlink" title="5. 同步和异步"></a>5. 同步和异步</h2><h3 id="5-1-同步-异步概念"><a href="#5-1-同步-异步概念" class="headerlink" title="5.1 同步/异步概念"></a>5.1 同步/异步概念</h3><p>  同步: ==顺序执行==  第一步—&gt; 第二步 —&gt; 第三步 ….</p>
<p>  异步:  甲在完成一系列工作时，自己完成主工作。将一些分支工作交给乙，甲此时一直在完成自己的工作，并等待乙完成的结果。乙完成后将结果返回给甲。</p>
<p><img alt="1523702943751" data-src="assets/12.png" class="lozad"></p>
<h3 id="5-2-案例"><a href="#5-2-案例" class="headerlink" title="5.2 案例"></a>5.2 案例</h3><p>  同时显示图片和弹出框</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script src=&quot;../AJax-1/student/Xhr.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var xhr = getXhr();</span><br><span class="line">        xhr.onreadystatechange = function () &#123;</span><br><span class="line">            if (xhr.readyState == 4) &#123;</span><br><span class="line">                alert(xhr.responseText);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.open(&apos;get&apos;, &apos;./cache.php&apos;, false);  // false 表示同步</span><br><span class="line">        xhr.send();</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;img src=&quot;./pinpai.jpg&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><img alt="1540712883152" data-src="assets/1540712883152.png" class="lozad"></p>
<p>当参数3为 false时，执行同步。 ajax请求会等待后端返回的数据，等拿到数据之后，才开始渲染1.png图片</p>
<p>当参数3为 true时，执行异步。ajax发送请求之后，浏览器会继续执行，先渲染1.png图片，当ajax接收到后端返回数据时再弹出时间戳。</p>
<p><img alt="1540712999763" data-src="assets/1540712999763.png" class="lozad"></p>
<h2 id="6-XMLHttpRequest2-0新特性"><a href="#6-XMLHttpRequest2-0新特性" class="headerlink" title="6. XMLHttpRequest2.0新特性"></a>6. XMLHttpRequest2.0新特性</h2><h3 id="2-1-timeout-和-ontimeout"><a href="#2-1-timeout-和-ontimeout" class="headerlink" title="2.1 timeout 和 ontimeout"></a>2.1 timeout 和 ontimeout</h3><p>timeout： 请求超时设置。属性，用来设置等待响应时长，如果超过指定时长，则会结束本次请求，并触发ontimeout事件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.timeout = 3000;    // 设置等待时长为3秒</span><br></pre></td></tr></table></figure>
<p>  ontimeout： 事件，用来设置超过等待时长后的动作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.ontimeout = function () &#123;</span><br><span class="line">	alert(&apos;请求超时&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在创建xhr对象之后，来设置timeout属性；如果设置了timeout属性，那么就建议设置ontimeout事件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script src=&quot;../AJax-1/student/Xhr.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var xhr = getXhr();</span><br><span class="line">        xhr.timeout = 3000;</span><br><span class="line">        xhr.ontimeout = function () &#123;</span><br><span class="line">            alert(&apos;请求超时！&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.onreadystatechange = function () &#123;</span><br><span class="line">            if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) &#123;</span><br><span class="line">                alert(xhr.responseText);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.open(&apos;get&apos;, &apos;./cache.php&apos;);</span><br><span class="line">        xhr.send();</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;img src=&quot;./pinpai.jpg&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>index.html 发送Ajax请求</p>
<p>   此处设置了 等待响应的时间， 并且设置了未接到响应的处理方式</p>
<p><img alt="1540713909090" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540713909090.png" class="lozad"></p>
<p>index.php</p>
<p><img alt="1540713921988" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540713921988.png" class="lozad"></p>
<h3 id="2-1-问题"><a href="#2-1-问题" class="headerlink" title="2.1 问题"></a>2.1 问题</h3><p>1、信息验证： 如果遇到有很多input框的问题，可以用事件委托给所有的表单添加onblur事件吗？ 还是把要把这段验证代码封装起来，而且对应的php页面又该怎么修改？</p>
<p>如果是每个input框都再新建一个php或者再写一段代码，那岂不是代码量很大？</p>
<p>答案：用内置对象formData对象</p>
<h2 id="7、FormData表单对象"><a href="#7、FormData表单对象" class="headerlink" title="7、FormData表单对象"></a>7、FormData表单对象</h2><p>小案例:  点击button按钮时，将表单的用户名和密码值通过ajax发送到后端php页面</p>
<p>DOM+Ajax方式：</p>
<p>表单中： form标签和input标签中的name都没用了。</p>
<p>​                submit按钮改为button</p>
<p><img alt="1540714599515" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540714599515.png" class="lozad"></p>
<p>发送请求时需要将用户名和密码拼接到地址之后</p>
<p><img alt="1540714680623" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540714680623.png" class="lozad"></p>
<p><img alt="1540714692669" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540714692669.png" class="lozad"></p>
<p>缺点：  当表单域太多时，获取表单域的数据和拼接传递数据的字符串都会变得很麻烦。</p>
<p>FormData对象优势就是能够一次性将表单中的所有数据全部取出，包括文件域的文件对象。</p>
<p>1) 创建表单<br>    ① 必须有form标签， method和action不重要<br>    ② 每个表单域需要设置name值</p>
<p><img alt="1540716307512" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540716307512.png" class="lozad"></p>
<p> 2)发送ajax请求</p>
<p>① 将表单数据取出 — FormData<br>i.获取form表单对象: var fm = document.getElementById(‘mainForm’);  //DOM对象<br>ii.实例化FormData对象:  var fd = new FormData(fm);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">② 发送ajax请求</span><br></pre></td></tr></table></figure>
<p>   使用FormData对象以后，必须使用post方式来发送ajax请求。<br>   将FormData对象，作为参数传入 send方法中  xhr.send(fd);</p>
<p>​    ③ 使用FormData对象提交表单时，不需要设置 setRequestHeader方法</p>
<p><img alt="1540716372581" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540716372581.png" class="lozad"></p>
<p>3) 在formdata.php页面，使用<code>$_POST</code>接收数据，文件数据要用<code>$_FILES</code></p>
<p><img alt="1540716423446" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-2/%E7%AC%94%E8%AE%B0/assets/1540716423446.png" class="lozad"></p>
<p>注意点: </p>
<blockquote>
<p>① form标签要给id值，方便获取form标签的DOM对象</p>
</blockquote>
<blockquote>
<p>② 每个域都要给 name值</p>
</blockquote>
<blockquote>
<p>③ 提交按钮必须用 button 不能用submit，因为submit有跳转功能</p>
</blockquote>
<blockquote>
<p>④ 使用formdata对象时，先获取form的DOM对象，再实例化FormData，并将form的DOM对象作为参数传入</p>
</blockquote>
<blockquote>
<p>⑤ 必须使用post方式来发送Ajax请求</p>
</blockquote>
<blockquote>
<p>⑥ 需要将fd对象作为参数传入send</p>
</blockquote>
<p>问题：提交过去的数据，用print_r($_post),php页面显示的是空数组Array ( ) Array ( ) </p>
<p>html获取的返回的数据则是一个字符串，需要用json来转换</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id=<span class="string">"forminfo"</span>&gt;</span><br><span class="line">        用户名：&lt;input type=<span class="string">"text"</span> name=<span class="string">"username"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line">        密码：  &lt;input type="text" name="userpwd"&gt;&lt;br&gt;</span><br><span class="line">        年龄：  &lt;input type="text" name="userage"&gt;&lt;br&gt;</span><br><span class="line">        上传文件：&lt;input type="file" name="userpic"&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type="button" value="提交" id="btn"&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">	// 输出之后为字符串</span><br><span class="line">    &lt;div class="box"&gt;</span><br><span class="line">        Array</span><br><span class="line">            (</span><br><span class="line">            [username] =&gt; QWE</span><br><span class="line">            [userpwd] =&gt; 123456</span><br><span class="line">            [userage] =&gt; 23</span><br><span class="line">            )</span><br><span class="line">            Array</span><br><span class="line">            (</span><br><span class="line">            [userpic] =&gt; Array</span><br><span class="line">            (</span><br><span class="line">            [name] =&gt; </span><br><span class="line">            [type] =&gt; </span><br><span class="line">            [tmp_name] =&gt; </span><br><span class="line">            [error] =&gt; 4</span><br><span class="line">            [size] =&gt; 0</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var box = document.querySelector('.box');</span><br><span class="line">        document.getElementById('btn').onclick = function () &#123;</span><br><span class="line">            var fm = document.getElementById('forminfo');</span><br><span class="line">            var fd = new FormData(fm);</span><br><span class="line">            var xhr = new XMLHttpRequest();</span><br><span class="line">            xhr.onreadystatechange = function () &#123;</span><br><span class="line">                if(xhr.readyState == 4) &#123;</span><br><span class="line">                    box.innerText = xhr.responseText;</span><br><span class="line">    / 接收响应的内容是字符串：xhr.responseText[0]是A【Array的首字母】</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            xhr.open('post', 'formdata.php');</span><br><span class="line">            xhr.send(fd);</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>响应的结果可以在这里看到</p>
<p><img alt="1540800822905" data-src="assets\1540800822905.png" class="lozad"></p>
<p>formdata.php页面</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    print_r($_POST);</span><br><span class="line">    print_r($_FILES);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img alt="1540801062940" data-src="assets\1540801062940.png" class="lozad"></p>
<h2 id="8、文件上传进度条案例"><a href="#8、文件上传进度条案例" class="headerlink" title="8、文件上传进度条案例"></a>8、文件上传进度条案例</h2><p>1) 完成Ajax文件上传</p>
<p>核心: Ajax方式上传文件必须使用FormData对象</p>
<p><strong>提示</strong>：一般上传大文件效果明显，20M以下基本看不出效果。</p>
<p>  关键点:<br>    ① 表单使用提交按钮，一定是button<br>    ② 获取文件对象 —- FormData<br>        i. 根据id获取form表单对象 —- DOM<br>        ii. 实例化 FormData对象，将表单对象作为参数传入<br>        iii. 因为使用了FormData，所以一定要用post方式发送请求，将fd作为参数传入send方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;span id=<span class="string">"pro-text"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;div id=<span class="string">"outer"</span> style=<span class="string">"width: 300px; height: 30px; border: 1px red solid"</span>&gt;</span><br><span class="line">    &lt;div id=<span class="string">"jdt"</span> style=<span class="string">"height: 30px; background-color: red; width: 0px"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;form id="form"&gt;</span></span><br><span class="line"><span class="regexp">选择文件: &lt;input type="file" name="pic"&gt;</span></span><br><span class="line"><span class="regexp">&lt;input id="btn" type="button" value="上传"&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>form&gt;</span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="comment">//1. 按钮上注册点击事件</span></span><br><span class="line"><span class="comment">//2. 事件函数</span></span><br><span class="line"><span class="comment">//  1) 获取文件对象 --- FormData</span></span><br><span class="line"><span class="comment">//    ① 获取form标签的DOM对象</span></span><br><span class="line"><span class="comment">//    ② 实例化FormData对象，并将form的DOM对象传入</span></span><br><span class="line"><span class="comment">//  2) 发送Ajax请求并将文件对象一起发送给后端</span></span><br><span class="line"><span class="comment">//    ① 创建xhr对象</span></span><br><span class="line"><span class="comment">//    ② 调用open方法</span></span><br><span class="line"><span class="comment">//    ③ 调用send方法</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1) 获取文件对象 --- FormData</span></span><br><span class="line">    <span class="keyword">var</span> fm = <span class="built_in">document</span>.getElementById(<span class="string">'form'</span>);</span><br><span class="line">    <span class="keyword">var</span> fd = <span class="keyword">new</span> FormData(fm);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2) 发送Ajax请求并将文件对象一起发送给后端</span></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (xhr.responseText == <span class="number">1</span>) &#123;</span><br><span class="line">                alert(<span class="string">'上传成功'</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                alert(<span class="string">'上传失败'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//console.log(xhr);</span></span><br><span class="line">    <span class="comment">//获取进度条对象</span></span><br><span class="line">    <span class="keyword">var</span> jdt_obj = <span class="built_in">document</span>.getElementById(<span class="string">'jdt'</span>);</span><br><span class="line">    <span class="keyword">var</span> span = <span class="built_in">document</span>.querySelector(<span class="string">'#pro-text'</span>);</span><br><span class="line">    <span class="comment">//重新绘制进度条的宽度</span></span><br><span class="line">    xhr.upload.onprogress = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//console.log(evt.loaded / evt.total); //0.347164736347364</span></span><br><span class="line">        <span class="keyword">var</span> percent = <span class="built_in">parseInt</span>((evt.loaded / evt.total) * <span class="number">100</span>);</span><br><span class="line">        jdt_obj.style.width = percent + <span class="string">'%'</span>;</span><br><span class="line">        span.innerText = percent + <span class="string">'%'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.open(<span class="string">'post'</span>, <span class="string">'upload.php'</span>);</span><br><span class="line">    xhr.send(fd);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br></pre></td></tr></table></figure>
<p>2) 调整PHP配置文件（php.ini），能够支持大文件上传</p>
<p> ① PHP配置文件中的两个配置项<br>     <strong>post_max_size</strong>: 设置post表单能够上传数据的最大值<br>     <strong>upload_max_filesize</strong>:  设置能够上传文件的最大值<br> ② <strong>重启apache</strong></p>
<p>3) 编写进度条</p>
<p>   ① 设置进度条所需的div<br>   ② 文件上传的核心事件  <strong>xhr.upload.onprogress</strong><br>    onprogress事件大约每100ms触发一次，该事件对象中有 loaded和total两个重要属性<br>        loaded：已上传文件大小<br>        total：文件总大小<br>   ③ 计算上传进度，修改进度条样式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取进度条对象</span></span><br><span class="line">  <span class="keyword">var</span> jdt_obj = <span class="built_in">document</span>.getElementById(<span class="string">'jdt'</span>);</span><br><span class="line">  <span class="keyword">var</span> span = <span class="built_in">document</span>.querySelector(<span class="string">'#pro-text'</span>);</span><br><span class="line"><span class="comment">//重新绘制进度条的宽度</span></span><br><span class="line">  xhr.upload.onprogress = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">      <span class="comment">//console.log(evt.loaded / evt.total); //0.347164736347364</span></span><br><span class="line">      <span class="keyword">var</span> percent = <span class="built_in">parseInt</span>((evt.loaded / evt.total) * <span class="number">100</span>);</span><br><span class="line">      jdt_obj.style.width = percent + <span class="string">'%'</span>;</span><br><span class="line">      span.innerText = percent + <span class="string">'%'</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>代码实现:</p>
<p> 1) 完成Ajax文件上传     —–   FormData<br>    静态文件(upload.html) —-  文件上传表单</p>
<p>​       ① 表单 </p>
<p><img alt="1540717602112" data-src="assets/1540717602112.png" class="lozad"></p>
<p>​      ② 获取文件对象，发送ajax请求并将文件对象一起发送给后端</p>
<p><img alt="1540717685761" data-src="assets/1540717685761.png" class="lozad"></p>
<p>​      ③ 创建upload.php文件  — 将上传文件从临时路径移动到目标路径</p>
<p><img alt="1540717733190" data-src="assets/1540717733190.png" class="lozad"></p>
<p> 2) 调整PHP配置文件，能够支持大文件上传  — php.ini</p>
<p>   ① 调整表单可以上传的总数据大小</p>
<p><img alt="1540717878035" data-src="assets/1540717878035.png" class="lozad"></p>
<p>   ② 调整允许上传的单个文件最大大小</p>
<p><img alt="1540717935876" data-src="assets/1540717935876.png" class="lozad"></p>
<p>③ 重启apache</p>
<p> 3) 编写进度条</p>
<p> ① 使用两个div来制作进度条</p>
<p><img alt="1540718368726" data-src="assets/1540718368726.png" class="lozad"></p>
<p>外层的div是 进度条的边框</p>
<p>内层才是真正的进度条，该进度条的宽会随着文件上传的大小而改变</p>
<p>② 通过onprogress事件的 <strong>loaded</strong> 和 <strong>total</strong>可以计算上传百分比，再* 300 就是进度条的宽度</p>
<p>xhr.upload.onprogress:  大约每100ms执行一次，该事件对象中有 loaded和total两个属性</p>
<p><img alt="1540720322152" data-src="assets/1540720322152.png" class="lozad"></p>
<h2 id="9、-JSON"><a href="#9、-JSON" class="headerlink" title="9、 JSON"></a>9、 JSON</h2><h3 id="1-、什么是JSON？"><a href="#1-、什么是JSON？" class="headerlink" title="1 、什么是JSON？"></a>1 、什么是JSON？</h3><p>JSON:  JavaScript Object Notation 是一种<strong>轻量级数据交互格式</strong>。 </p>
<p>数据交互: 每一种语言的编码都不一样，它们之间互不认识。但是现在的情况是不同的语言开发出的系统也需要进行数据交互，这时候就需要一种大家都认识的语言或者技术来实现。</p>
<p>重量级 ：XML、 数据库</p>
<h3 id="2、-JSON数据的声明和使用"><a href="#2、-JSON数据的声明和使用" class="headerlink" title="2、 JSON数据的声明和使用"></a>2、 JSON数据的声明和使用</h3><p>声明:  var json_obj = {“key1”:”value1”, “key2”:”value2”, …};<br>key: <strong>双引号包含的字符串（单引号不行）</strong><br>value: 数据–数值型、字符串、数组、json</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="keyword">var</span> json = &#123;<span class="string">"name"</span>:<span class="string">"zs"</span>, <span class="string">"age"</span>:<span class="number">20</span>&#125;;</span><br><span class="line">alert(json.name + json.age); <span class="comment">// zs20</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">name</span>:<span class="string">"zs"</span>, <span class="attr">age</span>:<span class="number">20</span>&#125;;</span><br><span class="line">alert(obj.name + obj.age); <span class="comment">// zs20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> json = &#123;</span><br><span class="line">    <span class="string">"team"</span>:<span class="string">"IG"</span>,</span><br><span class="line">    <span class="string">"num"</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">"member"</span>: [<span class="string">'上'</span>, <span class="string">'中'</span>, <span class="string">'下'</span>, <span class="string">'野'</span>, <span class="string">'辅'</span>],</span><br><span class="line">    <span class="string">"ceo"</span>: &#123;<span class="string">"name"</span>:<span class="string">"王思聪"</span>, <span class="string">"age"</span>:<span class="number">38</span>, <span class="string">"gender"</span>:<span class="string">"男"</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line">alert(json.member[<span class="number">1</span>]) <span class="comment">// 中</span></span><br><span class="line">alert(json.ceo.age); <span class="comment">// 38</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//数组，内部每个单元都是json</span></span><br><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">    &#123;<span class="string">"name"</span>:<span class="string">"zs"</span>, <span class="string">"age"</span>:<span class="number">20</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"name"</span>:<span class="string">"ls"</span>, <span class="string">"age"</span>:<span class="number">21</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"name"</span>:<span class="string">"ww"</span>, <span class="string">"age"</span>:<span class="number">25</span>&#125;</span><br><span class="line">];</span><br><span class="line">alert(arr[<span class="number">1</span>].name); <span class="comment">//ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//在声明和调用时都正常，但是别用</span></span><br><span class="line"><span class="keyword">var</span> json = &#123;<span class="string">'a'</span>:<span class="string">"hello"</span>, <span class="string">'b'</span>:<span class="string">'world'</span>&#125;;</span><br><span class="line">alert(json.a + json.b);  <span class="comment">// helloworld</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p><img alt="1540721099002" data-src="assets/1540721099002.png" class="lozad"></p>
<p>JSON的本质:  JSON 是 JS 对象的字符串表示法，它使用文本表示一个 JS 对象的信息，本质是一个字符串。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;a:"hello", b:"world"&#125;;       //  js对象</span><br><span class="line">var obj = &#123;"a":"hello", "b":"world"&#125;;  // json格式的js对象，也可以叫json对象 (JSON才是真正的JSON对象)</span><br><span class="line">var str = '&#123;"a":"hello", "b":"world"&#125;';   // json，也叫json格式的字符串</span><br><span class="line">必须外层单引号，内层双引</span><br></pre></td></tr></table></figure>
<p>var str = “{‘a’:’Hello’, ‘b’:’world’}”;  //错误，不能这样写，会影响到其他程序的执行<br>var str = {‘a’:”Hello”, ‘b’:”world”};  alert(str.a);  //虽然声明和调用都没问题，但是别用，因为在大段的程序中可能会发生数据转换错误。</p>
<h3 id="3、PHP中json与对象或数组互转"><a href="#3、PHP中json与对象或数组互转" class="headerlink" title="3、PHP中json与对象或数组互转"></a>3、PHP中json与对象或数组互转</h3><p> php提供了函数： <strong>json_encode($arr) </strong> ==&gt; json字符串</p>
<p>​                                <strong>json  dncode($str)</strong>   ==&gt;  json数组</p>
<h4 id="PHP数组转JSON格式的字符串"><a href="#PHP数组转JSON格式的字符串" class="headerlink" title="PHP数组转JSON格式的字符串"></a>PHP数组转JSON格式的字符串</h4><p>案例1: 索引数组转JSON  —&gt;  数组字符串</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//索引数组</span></span><br><span class="line">$arr = ['aaa', 'bbb', 'ccc'];</span><br><span class="line"><span class="comment">//使用json_encode将索引数组转为数组字符串</span></span><br><span class="line">echo json_encode($arr);  // '["aaa", "bbb", "ccc"]'</span><br></pre></td></tr></table></figure>
<p>案例2: 关联数组转 JSON  —&gt;  json’对象字符串‘</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//关联数组</span></span><br><span class="line">$info = ["name"=&gt;"于谦", "age"=&gt;60, "hobby"=&gt;"抽烟、喝酒、烫头"];</span><br><span class="line"><span class="comment">//使用json_encode将关联数组转为 json字符串</span></span><br><span class="line">echo json_encode($info); // '&#123;"name":"于谦", "age":60, "hobby":"抽烟、喝酒、烫头"&#125;'</span><br></pre></td></tr></table></figure>
<p>案例3: 二维数组转JSON  —&gt;  一维数组，每个单元都是一个json对象</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//二维数组</span></span><br><span class="line">$list = [</span><br><span class="line">    0=&gt;["name"=&gt;"于谦", "age"=&gt;60, "hobby"=&gt;"抽烟、喝酒、烫头"],</span><br><span class="line">    1=&gt;["name"=&gt;"老郭", "age"=&gt;50, "hobby"=&gt;"调戏柳岩"]</span><br><span class="line">];</span><br><span class="line">echo json_encode($list);</span><br><span class="line"><span class="comment">//'[&#123;"name":"于谦", "age":60, "hobby":"抽烟、喝酒、烫头"&#125;, &#123;"name":"老郭", "age":50, "hobby":"调戏柳岩"&#125;]'</span></span><br></pre></td></tr></table></figure>
<h3 id="4、JS中json与对象或数组互转"><a href="#4、JS中json与对象或数组互转" class="headerlink" title="4、JS中json与对象或数组互转"></a>4、JS中json与对象或数组互转</h3><p>JSON字符串转JSON对象 — javascript代码</p>
<p>前端的ajax请求，最后接收到的都是字符串 — responseText，以字符串形式接收后端返回的数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'[&#123;"id":10001,"name":"zs","age":20&#125;,&#123;"id":10002,"name":"ls","age":21&#125;,&#123;"id":10003,"name":"ww","age":19&#125;]'</span></span><br></pre></td></tr></table></figure>
<p>json格式的字符串转为json对象:  <strong>JSON.parse(json_str);</strong> </p>
<p>json格式的数组、对象转为json对象:  <strong>JSON.stingify(json_arr);</strong> </p>
<p>参数: json格式的字符串</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JSON.parse(var)</span></span><br><span class="line"><span class="comment"> * 将json字符串转为json对象</span></span><br><span class="line"><span class="comment"> * var能够使用 数组字符串  json字符串   数组，内部是json对象的字符串</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">var str = '["aaa","bbb","ccc"]';  //数组字符串</span><br><span class="line">console.log(JSON.parse(str));  //转化之后为：数组["aaa","bbb","ccc"]</span><br><span class="line"></span><br><span class="line">var json = '&#123;"name":"\u4e8e\u8c26","age":60,"hobby":"\u62bd\u70df\u3001\u559d\u9152\u3001\u70eb\u5934"&#125;';</span><br><span class="line">console.log(JSON.parse(json));   //json字符串转化之后为对象&#123;name: "于谦", age: 60, hobby: "抽烟、喝酒、烫头"&#125;</span><br><span class="line"></span><br><span class="line">var arr_str = '[&#123;"name":"\u4e8e\u8c26","age":60,"hobby":"\u62bd\u70df\u3001\u559d\u9152\u3001\u70eb\u5934"&#125;,&#123;"name":"\u8001\u90ed","age":50,"hobby":"\u8c03\u620f\u67f3\u5ca9"&#125;]';  //数组，内部是json对象的字符串</span><br><span class="line">console.log(JSON.parse(arr_str));  </span><br><span class="line"><span class="comment">// 转化之后为(2) </span></span><br><span class="line"><span class="comment">// [</span></span><br><span class="line"><span class="comment">//  &#123;name: "于谦", age: 60, hobby: "抽烟、喝酒、烫头"&#125;,</span></span><br><span class="line"><span class="comment">//  &#123;name: "老郭", age: 50, hobby: "调戏柳岩"&#125;</span></span><br><span class="line"><span class="comment">// ];</span></span><br></pre></td></tr></table></figure>
<p><img alt data-src="assets\关于 json.png" class="lozad"></p>
<h3 id="5、案例-—-搜索用户名，显示用户列表信息"><a href="#5、案例-—-搜索用户名，显示用户列表信息" class="headerlink" title="5、案例 — 搜索用户名，显示用户列表信息"></a>5、案例 — 搜索用户名，显示用户列表信息</h3><p> 思路:<br>1) 创建一个搜索页面，定义好搜索框，表头。在搜索按钮上绑定点击事件。<br>2) 点击事件能够发送ajax请求，并将用户名文本框中的内容一起发送到后端php程序<br>3) 后端php程序接收用户名，链接MySQL进行模糊查询，再将数组返回给前端<br>4) 前端接收到后端php返回值之后，循环显示出来</p>
<p>代码实现 : </p>
<p>1) 创建一个搜索页面，定义好搜索框，表头。在搜索按钮上绑定点击事件。</p>
<p>2) 点击事件能够发送ajax请求，并将用户名文本框中的内容一起发送到后端php程序</p>
<p>在搜索按钮上绑定点击事件 — 获取文本框中的用户名，发送ajax请求</p>
<p>3) 后端php程序接收用户名，链接MySQL进行模糊查询，再将数组返回给前端</p>
<p>4) 前端接收到后端php返回值之后，循环显示出来</p>
<p>html页面</p>
<ol>
<li><p>1)  设置搜索表单 和  表格</p>
<p>2)  搜索按钮上绑定点击事件，获取关键词并发送Ajax请求</p>
</li>
</ol>
<p><img alt="1540885317169" data-src="assets/1540885317169.png" class="lozad"></p>
<p><img alt="1540885589631" data-src="assets/1540885589631.png" class="lozad"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .box &#123;</span><br><span class="line">                width: 260px;</span><br><span class="line">                height: 40px;</span><br><span class="line">            &#125;   </span><br><span class="line">            form &#123;</span><br><span class="line">                display: block;</span><br><span class="line">                font-size: 0;</span><br><span class="line">            &#125;</span><br><span class="line">            form input &#123;</span><br><span class="line">                height: 30px;</span><br><span class="line">            &#125;</span><br><span class="line">            form input:first-child &#123;</span><br><span class="line">                width: 200px;</span><br><span class="line">            &#125;   </span><br><span class="line">            form input:last-child &#123;</span><br><span class="line">                height: 36px;</span><br><span class="line">                border: none;</span><br><span class="line">                vertical-align: top;</span><br><span class="line">            &#125;   </span><br><span class="line">            .datable table &#123;</span><br><span class="line">                width: 600px;</span><br><span class="line">                border: 1px solid black;</span><br><span class="line">                border-collapse: collapse;</span><br><span class="line">            &#125;   </span><br><span class="line">            .datable td,</span><br><span class="line">            .datable th &#123;</span><br><span class="line">                border: 1px solid black;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">        &lt;form id=&quot;searchbox&quot;&gt;</span><br><span class="line">            &lt;input id=&quot;searchtext&quot; type=&quot;text&quot;&gt;</span><br><span class="line">            &lt;input id=&apos;btn&apos; type=&quot;button&quot; value=&quot;搜索&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;datable&quot;&gt;</span><br><span class="line">            &lt;table&gt;</span><br><span class="line">                &lt;thead&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;th&gt;id&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;邮箱&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;密码&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;手机&lt;/th&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/thead&gt;</span><br><span class="line">                &lt;tbody id=&quot;tb&quot;&gt;</span><br><span class="line">                &lt;/tbody&gt;</span><br><span class="line">            &lt;/table&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script src=&quot;../Xhr.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        document.getElementById(&apos;btn&apos;).onclick = function () &#123;</span><br><span class="line">            var xhr = getXhr();</span><br><span class="line">            var key = document.getElementById(&apos;searchtext&apos;).value;</span><br><span class="line">            if( key.trim() == &apos;&apos;) &#123;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">            xhr.onreadystatechange = function () &#123;</span><br><span class="line">                if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) &#123;</span><br><span class="line">                    var arr = JSON.parse(xhr.responseText);</span><br><span class="line">                    // 遍历传回来之后json转化的数组，拼接字符串，添加进tbody中</span><br><span class="line">                    var str = &apos;&apos;;</span><br><span class="line">                    arr.forEach(function (item , index) &#123;</span><br><span class="line">                        str += &apos;&lt;tr&gt; &apos;+ </span><br><span class="line">                            &apos;&lt;td&gt;&apos;+ item.sno +&apos;&lt;/td&gt;&apos;+</span><br><span class="line">                            &apos;&lt;td&gt;&apos;+ item.sname +&apos;&lt;/td&gt;&apos;+</span><br><span class="line">                            &apos;&lt;td&gt;&apos;+ item.sage +&apos;&lt;/td&gt;&apos;+</span><br><span class="line">                            &apos;&lt;td&gt;&apos;+ item.sgender +&apos;&lt;/td&gt;&apos;+</span><br><span class="line">                            &apos;&lt;td&gt;&apos;+ item.semail +&apos;&lt;/td&gt;&apos;+</span><br><span class="line">                            &apos;&lt;td&gt;&apos;+ item.spwd +&apos;&lt;/td&gt;&apos;+</span><br><span class="line">                            &apos;&lt;td&gt;&apos;+ item.stel +&apos;&lt;/td&gt;&apos;+</span><br><span class="line">                            &apos;&lt;/tr&gt;&apos;; </span><br><span class="line">                        document.getElementById(&apos;tb&apos;).innerHTML = str;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            // 将获取表单的value提交给后台页面</span><br><span class="line">            xhr.open(&apos;get&apos;, &apos;./searchdb2.php?key=&apos; + key + &apos;&amp;_=&apos; + Math.random());</span><br><span class="line">            xhr.send();</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>php页面</p>
<ol>
<li><p>search.php</p>
<p>1) 接收关键词</p>
<p>2) 拼接SQL语句</p>
<p>3) 链接MySQL服务器并执行SQL语句</p>
<p>4) 将查询结果返回给前端</p>
</li>
</ol>
<p><img alt="1540886311214" data-src="assets/1540886311214.png" class="lozad"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="comment">// 获得前端传输来的数据</span></span><br><span class="line">   $key =  $_GET[<span class="string">'key'</span>];</span><br><span class="line">   <span class="comment">// 编写MySQL语句</span></span><br><span class="line">   $str = <span class="string">"select * from student where semail like '%$key%'"</span>;</span><br><span class="line">   <span class="comment">// 链接数据库，设置字符集，执行语句获得结果</span></span><br><span class="line">   $conn = mysqli_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>, <span class="string">'study'</span>);</span><br><span class="line">   mysqli_query($conn, <span class="string">'set names utf8'</span>);</span><br><span class="line">   $result = mysqli_query($conn, $str);</span><br><span class="line">   <span class="comment">// 结果是一个二维数组，所以需要循环接收到一个数组里</span></span><br><span class="line">   $arr = [];</span><br><span class="line">   <span class="keyword">while</span>($row = mysqli_fetch_assoc($result)) &#123;</span><br><span class="line">       $arr[] = $row;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">echo</span> json_encode($arr);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>search.html</p>
<p>1) 接收后端返回结果</p>
<p>2) 将结果拼接成tr-td的字符串，并写回tbody标签中</p>
</li>
</ol>
<p><img alt="1540887014654" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-3/%E7%AC%94%E8%AE%B0/assets/1540887014654.png" class="lozad"></p>
<h2 id="10、jQuery提供的Ajax方法"><a href="#10、jQuery提供的Ajax方法" class="headerlink" title="10、jQuery提供的Ajax方法"></a>10、jQuery提供的Ajax方法</h2><p> jQuery提供了4个ajax方法:  <code>$.get()  $.post()  $.ajax()  $.getJSON()</code></p>
<p> 前三个常用</p>
<h3 id="1、-get"><a href="#1、-get" class="headerlink" title="1、$.get"></a>1、$.get</h3><p> $.get(var1, var2, var3, var4);<br>  参数1: 请求的后端程序的地址<br>  参数2: 要发送到后端程序的数据，json对象/js对象（推荐）或者 字符串<br>  参数3: 当readyState==4时的回调函数，该函数中有一个参数，就是后端程序返回的数据<br>  参数4: 设置返回数据的类型:  text(默认)  、json  、 xml等</p>
<p>案例1 在get.html文件中发送一个ajax请求，去请求后端的getData.php页面，同时将id=1数据发送给后端</p>
<p>原生js写法：</p>
<p><img alt="1540887870138" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-3/%E7%AC%94%E8%AE%B0/assets/1540887870138.png" class="lozad"></p>
<p>使用$.get方法：</p>
<p><img alt="1540888474167" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-3/%E7%AC%94%E8%AE%B0/assets/1540888474167.png" class="lozad"></p>
<p>案例2 使用$.get改造用户名搜索案例</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class="box"&gt;</span><br><span class="line">        &lt;form id="searchbox"&gt;</span><br><span class="line">            &lt;input id="searchtext" type="text"&gt;</span><br><span class="line">            &lt;input id='btn' type="button" value="搜索"&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;div class="datable"&gt;</span><br><span class="line">            &lt;table&gt;</span><br><span class="line">                &lt;thead&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;th&gt;id&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;邮箱&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;密码&lt;/th&gt;</span><br><span class="line">                        &lt;th&gt;手机&lt;/th&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/thead&gt;</span><br><span class="line">                &lt;tbody id="tb"&gt;</span><br><span class="line">                &lt;/tbody&gt;</span><br><span class="line">            &lt;/table&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script src="./jquery-1.8.3.min.js"&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src="./Xhr.js"&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        $('#btn').click(function () &#123;</span><br><span class="line">            var key = $('#searchtext').val();</span><br><span class="line">            if( key.trim() == '') &#123;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">            $.get('./get.php', &#123;'key': key&#125;, function (data) &#123;</span><br><span class="line">                console.log(data);</span><br><span class="line">                var str = '';</span><br><span class="line">                data.forEach(function (item) &#123;</span><br><span class="line">                    str += '&lt;tr&gt;'+ </span><br><span class="line">                           '&lt;td&gt;'+ item.sno +'&lt;/td&gt;'+</span><br><span class="line">                           '&lt;td&gt;'+ item.sname +'&lt;/td&gt;'+</span><br><span class="line">                           '&lt;td&gt;'+ item.sage +'&lt;/td&gt;'+</span><br><span class="line">                           '&lt;td&gt;'+ item.sgender +'&lt;/td&gt;'+</span><br><span class="line">                           '&lt;td&gt;'+ item.semail +'&lt;/td&gt;'+</span><br><span class="line">                           '&lt;td&gt;'+ item.spwd +'&lt;/td&gt;'+</span><br><span class="line">                           '&lt;td&gt;'+ item.stel +'&lt;/td&gt;'+</span><br><span class="line">                           '&lt;/tr&gt;';                  </span><br><span class="line">                &#125;)</span><br><span class="line">                $('#tb').html(str);</span><br><span class="line">            &#125;, 'json');         </span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><img alt="1540889605483" data-src="assets/1540889605483.png" class="lozad"></p>
<h3 id="2、-post"><a href="#2、-post" class="headerlink" title="2、$.post"></a>2、$.post</h3><p><code>$.post</code>函数的用法和<code>$.get</code>一模一样，只是发送请求方式变为post</p>
<p> $.post(var1, var2, var3 , var4);    //最标准的写法<br>  参数1: 请求的后端程序的地址<br>  参数2: 要发送到后端程序的数据，json对象/js对象（推荐） 或者 字符串<br>  参数3: 当readyState=4时的回调函数，该函数中有一个参数，就是后端程序返回的数据<br>  参数4: 设置返回数据的类型:  text(默认)  json     xml</p>
<p>案例: 在post.html文件中发送一个ajax请求，去请求后端的postData.php页面，同时将id=1数据发送给后端</p>
<p><img alt="1540890061496" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-3/%E7%AC%94%E8%AE%B0/assets/1540890061496.png" class="lozad"></p>
<h3 id="3、案例-—-搜索框下拉列表"><a href="#3、案例-—-搜索框下拉列表" class="headerlink" title="3、案例 — 搜索框下拉列表"></a>3、案例 — 搜索框下拉列表</h3><p><img alt data-src="assets\1 (3" class="lozad">.png)</p>
<p>数据表设计:</p>
<p><img alt data-src="assets\2 (2" class="lozad">.png)</p>
<p>key_id: 主键</p>
<p>key_name: 关键词</p>
<p> 思路分析:</p>
<ol>
<li><p>index.html  —  在搜索框上绑定keyup事件，获取搜索框内容并发送ajax请求</p>
<p>1) 在搜索文本框上绑定键盘弹起事件</p>
<p>2) 事件函数</p>
<p>   ① 获取搜索框内容</p>
<p>   ② 发送ajax请求</p>
</li>
<li><p>getKeys.php —  接收关键词，并根据关键词从数据表中查出相关的其他关键词，返回给前端</p>
<p>1) 接收关键词</p>
<p>2) 编写SQL语句 — 模糊查询</p>
<p>3) 链接MySQL服务器并执行SQL语句</p>
<p>4) 将查询结果返回给前端</p>
</li>
<li><p>index.html — 将接收到关键词循环显示到下拉列表（tips）中</p>
<p>1) 制作下拉列表</p>
<p>2) 将后端返回的每条关键词都填充到下拉列表中，并注册相关的 鼠标进入、离开、点击事件</p>
<p>3) 完善下拉列表</p>
<p>  ① 在循环向下拉菜单添加数据之前要情况下拉菜单中已有的数据</p>
<p>  ② 文本框限制不能有空格关键词，关键词长度大于0才能触发ajax请求</p>
<p>  ③  当关键词为空时，隐藏下拉菜单</p>
</li>
</ol>
<p>代码实现:</p>
<ol>
<li>index.html  —  在搜索框上绑定keyup事件，获取搜索框内容并发送ajax请求</li>
</ol>
<p><img alt="1540890973521" data-src="assets/1540890973521.png" class="lozad"></p>
<ol>
<li>getKeys.php —  接收关键词，并根据关键词从数据表中查出相关的其他关键词，返回给前端</li>
</ol>
<p><img alt="1540891236119" data-src="assets/1540891236119.png" class="lozad"></p>
<p>1、index.html — 将接收到关键词循环显示到下拉列表（tips）中</p>
<p>① 设置下拉列表</p>
<p><img alt="1540891766890" data-src="assets/1540891766890.png" class="lozad"></p>
<p>② 循环接收到后端数据，将得到的关键词写入tips中</p>
<p><img alt="1540893587708" data-src="assets/1540893587708.png" class="lozad"></p>
<p><img alt="1540893611213" data-src="assets/1540893611213.png" class="lozad"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给搜索框添加oninput,或者onkeydown事件事件</span></span><br><span class="line"><span class="keyword">var</span> value;</span><br><span class="line">$(<span class="string">'.txt'</span>).keyup(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 点击按钮后获取value值，去掉两边空格</span></span><br><span class="line">    value = $(<span class="string">'.txt'</span>).val().trim();</span><br><span class="line">    <span class="comment">// 首先判断是否为空，为空则不能向下执行</span></span><br><span class="line">    <span class="keyword">if</span>(value == <span class="string">''</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 向后台发送数据【关键字】</span></span><br><span class="line">    $.post(<span class="string">'./php/keydata.php'</span>, &#123; <span class="string">"k"</span>: value &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 判断返回的数据是否为空，为空则不能向下执行，下拉列表隐藏</span></span><br><span class="line">        <span class="keyword">if</span> (data == <span class="string">'[]'</span>) &#123;</span><br><span class="line">            $(<span class="string">'.key-list'</span>).hide();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> arr = <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">        $(<span class="string">'.key-list'</span>).show().empty();  <span class="comment">// 接收并清空原来的下拉列表</span></span><br><span class="line">        arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;   <span class="comment">// 循环数据数组打印数据在下拉列表中</span></span><br><span class="line">            <span class="keyword">if</span>(item.key_name == $(<span class="string">'.txt'</span>).val()) &#123;  <span class="comment">// 当鼠标移开之后，再次进入搜索栏区域，</span></span><br><span class="line">                $(<span class="string">'.key-list'</span>).hide();  <span class="comment">// 重新判断要输入下拉列表的值和input搜索框中的值是否相等，相等则不打印div</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> $div = $(<span class="string">'&lt;div&gt;&lt;/div&gt;'</span>);</span><br><span class="line">            $div.html(item.key_name);</span><br><span class="line">            $(<span class="string">'.key-list'</span>).append($div);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">$(<span class="string">'.search'</span>).mouseleave(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">'.key-list'</span>).hide();  <span class="comment">// 鼠标离开搜索框区域，隐藏下拉列表</span></span><br><span class="line">&#125;).mouseenter(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">'.txt'</span>).keyup();     <span class="comment">// 鼠标移上搜索框区域，重新调用keyup事件进行发送验证数据。</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 选中下拉选项后，把内容赋值给input搜索框，并隐藏下拉列表</span></span><br><span class="line">$(<span class="string">'.key-list'</span>).on(<span class="string">'click'</span>, <span class="string">'div'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">'.txt'</span>).val($(<span class="keyword">this</span>).text());</span><br><span class="line">    $(<span class="string">'.key-list'</span>).hide();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>关键点总结:</p>
<p>1) 使用键盘弹起事件来触发ajax请求</p>
<p>   ① 获取搜索框中的内容</p>
<p>   ② 发送ajax请求，并将搜索框中的内容一起发送给后端</p>
<p>2) 接收到的数据需要循环显示在下拉菜单中</p>
<p>   ① 将返回的字符串转为数组（内部是json对象）</p>
<p>   ② 循环数组，取出每一个相似关键词</p>
<p>   ③ 在循环中创建div对象，将关键词加入div对象</p>
<p>   ④ 在div上绑定鼠标悬浮事件，修改背景和字体颜色</p>
<p>   ⑤ 在div上绑定鼠标移出事件，修改背景和字体颜色为初始颜色</p>
<p>   ⑥ 在div上绑定点击事件，将内容写在搜索框中，并隐藏下拉列表</p>
<p>   ⑦ 将div追加到下拉列表中，然后再将下拉列表显示出来</p>
<p>   ⑧ 在循环显示下拉列表之前先清空下拉列表中已有内容</p>
<p>   ⑨ 当关键词长度为0时，不能发送ajax请求，同时还要将tips隐藏</p>
<p>   ⑩ 获取关键词时，要将左右两侧的空格去掉</p>
<p>   11 如果后端返回的数据为空时，就不能循环显示结果</p>
<h3 id="4、-ajax"><a href="#4、-ajax" class="headerlink" title="4、$.ajax"></a>4、$.ajax</h3><p> <code>$.ajax</code>使用JS对象来配置ajax请求  —  $.ajax(obj);</p>
<p> 必须配置项：<br> <strong>url:</strong>         要请求的后台程序地址<br> <strong>data:</strong>      要发送到后台程序的数据 (可以使用字符串、js、json、fd)<br> <strong>type:</strong>      请求类型  post和get 两种  （还有put和delete）<br> <strong>dataType:</strong>  返回值类型  text(默认) 、 json 、xml 、 jsonp(跨域使用)<br> <strong>success:</strong>   成功完成ajax请求之后的回调函数，其参数是后端程序的返回数据</p>
<p>简单案例: 在ajax.html文件中发送一个ajax请求，去请求后端的ajaxData.php页面，同时将id=1数据发送给后端</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"./jquery-1.8.3.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'./ajaxData.php'</span>,    <span class="comment">// './ajaxData.php?id=1'</span></span><br><span class="line">    data: <span class="string">'id=1'</span>, <span class="comment">//&#123;id:1&#125; &#123;"id":1&#125;</span></span><br><span class="line">    type: <span class="string">'post'</span>,  <span class="comment">//默认 get</span></span><br><span class="line">    dataType: <span class="string">'json'</span>,  <span class="comment">//默认  text</span></span><br><span class="line">    <span class="comment">//cache: false, // false不缓存  true缓存</span></span><br><span class="line">    <span class="keyword">async</span>: <span class="literal">true</span>,   <span class="comment">// true 异步 默认   false同步</span></span><br><span class="line">    timeout: <span class="number">1000</span>,  <span class="comment">//1秒内没有接收到后端返回的数据，则结束当前ajax请求</span></span><br><span class="line">    beforeSend: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//发送Ajax之前执行方法</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'发送ajax前执行beforeSend'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        alert(data);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//一旦Ajax请求失败，就会进入该方法</span></span><br><span class="line">    error: <span class="function"><span class="keyword">function</span> (<span class="params">xhr, errMsg</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(errMsg);</span><br><span class="line">    &#125;,</span><br><span class="line">    complete: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//ajax请求完成之后触发的回调函数,不论成功还是失败都执行</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'complete run'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p><img alt="1540894587955" data-src="C:/Users/Administrator/Desktop/%E9%9A%8F%E5%A0%82%E6%96%87%E4%BB%B6/ajax-3/%E7%AC%94%E8%AE%B0/assets/1540894587955.png" class="lozad"></p>
<p>其他配置项：</p>
<p><strong>cache</strong>: 是否进行缓存(true缓存/fasle不缓存)，如果设置type为get，一般设置该项为false(不缓存)。<br><strong>async:</strong> 同步/异步设置，true(异步、默认)  false(同步)。<br><strong>timeout:</strong> 超时设置，多少ms之后扔未接收到后端返回数据，则结束本次请求。— 进入error方法中<br><strong>error:</strong> 请求失败时的回调函数，该函数有三个参数。参数1是xhr对象，参数2是错误信息（错误信息通常是 “null”, “timeout”, “error”, “notmodified” 和 “parsererror”），参数3是异常对象。<br><strong>complete:</strong> Ajax完成时的回调函数。<br><strong>beforeSend:</strong> 发送Ajax之前执行的回调函数。</p>
<p>程序执行函数顺序：beforeSend —&gt;  success/error  —&gt; complete</p>
<p><strong>contentType:</strong>  头信息设置，使用FormData对象时设置该值为false，其他情况会自动设置，不需要手动设置。</p>
<p><strong>processData:</strong>  处理数据方式，使用FormData对象时设置该值为false，其他情况会自动设置，不需要手动设置。</p>
<p><strong>注意:</strong> contentType和processData只有在发送到后端的数据为FormData是才设置为false，其余情况均不用设置</p>
<p>案例: 使用 $.ajax方法完成添加新学生的操作</p>
<p>   student.html</p>
<p>​    1) 设置表单</p>
<p>​        2) 在添加按钮上注册点击事件，获取表单数据(FormData)，发送ajax请求</p>
<p>​    3) 接收后端返回的结果，提示添加成功/添加失败</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id=<span class="string">"fada"</span>&gt;</span><br><span class="line">        &lt;h3&gt;学生信息&lt;<span class="regexp">/h3&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">        姓名：&lt;input id="sname" type="text" name="sname"&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">        年龄：&lt;input type="text" name="sage"&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">        性别：&lt;input type="text" name="sgender"&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">        邮箱：&lt;input type="text" name="semail"&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">        密码：&lt;input type="text" name="spwd"&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">        手机：&lt;input type="text" name="stel"&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input id="btn" type="button" value="提交"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>form&gt;</span><br><span class="line">    &lt;script src=<span class="string">"../jquery-1.8.3.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    &lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">        $(<span class="string">'#btn'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> fm = $(<span class="string">'#fada'</span>)[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">var</span> fd = <span class="keyword">new</span> FormData(fm);</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                url: <span class="string">'./$ajax-stutab.php'</span>,</span><br><span class="line">                data: fd,</span><br><span class="line">                type: <span class="string">'post'</span>,</span><br><span class="line">                contentType: <span class="literal">false</span>,</span><br><span class="line">                processData: <span class="literal">false</span>,</span><br><span class="line">                dataType: <span class="string">'json'</span>,</span><br><span class="line">                beforeSend: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> ($(<span class="string">'#sname'</span>).val().trim().length == <span class="number">0</span>) &#123;</span><br><span class="line">                        alert(<span class="string">'用户名不能为空！'</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(data == <span class="number">1</span>) &#123;</span><br><span class="line">                        alert(<span class="string">'添加成功！'</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(data == <span class="number">2</span>) &#123;</span><br><span class="line">                        alert(<span class="string">'添加失败！'</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                error: <span class="function"><span class="keyword">function</span> (<span class="params">xhr, errMsg</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (errMsg == <span class="string">'timeout'</span>) &#123;</span><br><span class="line">                        alert(<span class="string">'服务器无响应'</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        alert(<span class="string">'服务器端出错'</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">        		&#125;,</span><br><span class="line">                complete: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    alert(<span class="string">'结束'</span>);</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br></pre></td></tr></table></figure>
<p>  <img alt="1540896502676" data-src="assets/1540896502676.png" class="lozad"></p>
<p>   <img alt="1540896517513" data-src="assets/1540896517513.png" class="lozad"></p>
<p> <img alt="51540896531007" data-src="assets/1540896531007.png" class="lozad"></p>
<p>   student.php</p>
<p>​         1) 接收前端提交的数据</p>
<p>​         2) 拼接SQL语句 — insert into</p>
<p>​         3) 链接MySQL服务器并执行SQL语句</p>
<p>​         4) 返回执行结果</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $name = $_POST[<span class="string">'sname'</span>];</span><br><span class="line">    $age = $_POST[<span class="string">'sage'</span>];</span><br><span class="line">    $gender = $_POST[<span class="string">'sgender'</span>];</span><br><span class="line">    $email = $_POST[<span class="string">'semail'</span>];</span><br><span class="line">    $pwd = $_POST[<span class="string">'spwd'</span>];</span><br><span class="line">    $tel = $_POST[<span class="string">'stel'</span>];</span><br><span class="line">    </span><br><span class="line">    $str = <span class="string">"insert into student </span></span><br><span class="line"><span class="string">            values(null, '$name', $age, '$gender', '$email', '$pwd', '$tel')"</span>;</span><br><span class="line">    $conn = mysqli_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>, <span class="string">'study'</span>);</span><br><span class="line">    mysqli_query($conn, <span class="string">'set names utf8'</span>);</span><br><span class="line">    <span class="keyword">if</span>(mysqli_query($conn, $str)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5、-“form”-serialize"><a href="#5、-“form”-serialize" class="headerlink" title="5、$(“form”).serialize()"></a>5、$(“form”).serialize()</h3><p>简介：</p>
<p>serialize（）和new FormDate（）javascript序列化表单的方法，所谓序列化表单就是讲form表单中所有name属性序列化成KEY-VALUE的形式，提交到后台，后台以对象相应的字段接收。实现表单的异步提交。</p>
<p>区别：</p>
<p>1，new FormDate（）支持表单中文件二进制流形式提交，也就是支持上传文件，serialize（）不支持文件二进制流提交。</p>
<p> 2，seriaLize()是jquery方法</p>
<p>代码实例：</p>
<p>1，var form = new FormData(document.getElementByIdx_x(“add_form”));</p>
<p> 2，$(“#add_form”).serialize()；</p>
<p>3，html部分</p>
<p>注意事项：</p>
<p>1，注意中文乱码</p>
<p> 2，如果form表单中不含文件二进制形式尽量使用serialize（）方法，避免一些浏览器不兼容的解码错误。遇到过一次IE浏览器死活不兼容在不包含文件的form表单使用new formdata序列化的事情，最后换serialize（）解决了问题</p>
<h2 id="11、自己封装Ajax-—-和jQuery一样"><a href="#11、自己封装Ajax-—-和jQuery一样" class="headerlink" title="11、自己封装Ajax — 和jQuery一样"></a>11、自己封装Ajax — 和jQuery一样</h2><p>从一般到通用。<br>从一个具体的案例，完善成一个兼容相同功能函数<br>  1) 编写一个具体案例<br>  2) 分析其中的缺陷<br>  3) 完善缺陷</p>
<h3 id="2-1-封装-get方法"><a href="#2-1-封装-get方法" class="headerlink" title="2.1 封装 $.get方法"></a>2.1 封装 $.get方法</h3><p> 1) 编写一个具体的案例<br>     具体案例:  封装一个get方法，能够发送ajax请求，请求1.php文件，并且能接收到1.php的返回数据</p>
<p><img alt="1540979829771" data-src="assets/1540979829771.png" class="lozad"></p>
<p> 2) 分析缺陷</p>
<p>   ① 在创建XMLHttpRequest对象时，没有处理浏览器兼容性<br>   ② 只能访问1.php程序<br>   ③ 无法灵活向后台的页面发送参数<br>   ④ 接收到的数据只能输出到终端，不够灵活<br>   ⑤ 返回值类型单一，只能使用字符串 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $ = &#123;</span><br><span class="line">    <span class="keyword">get</span>: function (url, value, success, dataType) &#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">this</span>.getXhr();</span><br><span class="line">        xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(xhr.readyState == <span class="number">4</span> &amp;&amp; xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> data = xhr.responseText;</span><br><span class="line">                <span class="keyword">if</span>( dataType == <span class="string">'json'</span>) &#123;</span><br><span class="line">                    data = <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">                &#125;</span><br><span class="line">                success(data);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>( <span class="keyword">typeof</span> value == <span class="string">'object'</span>) &#123;</span><br><span class="line">            value = <span class="keyword">this</span>.params(value);</span><br><span class="line">        &#125;</span><br><span class="line">        url = url + <span class="string">'?'</span> + value;</span><br><span class="line">        xhr.open(<span class="string">'get'</span>, url);</span><br><span class="line">        xhr.send();</span><br><span class="line">    &#125;,</span><br><span class="line">    getXhr: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">            xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Msxml2.XMLHTTP'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> xhr;</span><br><span class="line">    &#125;,</span><br><span class="line">    params: <span class="function"><span class="keyword">function</span> (<span class="params">object</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> value = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> object) &#123;</span><br><span class="line">            value += key + <span class="string">'='</span> + object[key] + <span class="string">'&amp;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 3) 完善缺陷</p>
<p>   ① 在创建XMLHttpRequest对象时，没有处理浏览器兼容性</p>
<p><img alt="1540980185951" data-src="assets/1540980185951.png" class="lozad"></p>
<p>   ② 只能访问1.php程序</p>
<p><img alt="1540980289970" data-src="assets/1540980289970.png" class="lozad"></p>
<p>   ③ 无法灵活向后台的页面发送参数  </p>
<p>​     i. 编写params方法用来将js/json对象转为字符串</p>
<p>​       {id:1, name:”zs”}  ====&gt; ‘id=1&amp;name=zs’</p>
<p><img alt="1540981132282" data-src="assets/1540981132282.png" class="lozad"></p>
<p>​    ii. 在get方法中判断data的数据类型，如果是对象(object)则调用 params方法将对象转为字符串，再将字符串拼接到url地址当中</p>
<p><img alt="1540981202712" data-src="assets/1540981202712.png" class="lozad"></p>
<p>​    iii. 调用get方法的时候，可是用字符串和js/json对象来测试</p>
<p><img alt="1540981248028" data-src="assets/1540981248028.png" class="lozad"></p>
<p>测试结果:</p>
<p><img alt="1540981269127" data-src="assets/1540981269127.png" class="lozad"></p>
<p>   ④ 接收到的数据只能输出到终端，不够灵活</p>
<p>​    i. 在get方法中定义参数3， 在if程序块中做成函数调用，并将后端返回的数据作为参数传入</p>
<p><img alt="1540981921744" data-src="assets/1540981921744.png" class="lozad"></p>
<p>   ii. 在调用get方式时，传一个函数，该函数中定义一个参数，用来接收后端返回的数据。 接收到的数据就能够在函数中随意使用</p>
<p><img alt="1540982002689" data-src="assets/1540982002689.png" class="lozad"></p>
<p>   ⑤ 返回值类型单一，只能使用字符串</p>
<p>  i. 在get方法中增加参数4，在接收数据的程序块中判断参数4是否为json，如果等于json则执行JSON.parse</p>
<p><img alt="1540982342087" data-src="assets/1540982342087.png" class="lozad"></p>
<p>   ii. 调用get方法时，要增加参数4</p>
<p><img alt="1540982362510" data-src="assets/1540982362510.png" class="lozad"></p>
<h3 id="2-2-封装-post方法"><a href="#2-2-封装-post方法" class="headerlink" title="2.2 封装 $.post方法"></a>2.2 封装 $.post方法</h3><p> 1) 编写一个具体的案例<br>     具体案例:  封装一个post方法，能够发送ajax请求，请求1.php文件，并且能接收到1.php的返回数据</p>
<p> 2) 分析缺陷</p>
<p>   ① 在创建XMLHttpRequest对象时，没有处理浏览器兼容性<br>   ② 只能访问1.php程序<br>   ③ 无法灵活向后台的1.php程序发送参数<br>   ④ 前端无法灵活接收后端返回的数据<br>   ⑤ 返回值类型单一，只能使用字符串 </p>
<p> 3) 完善缺陷</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $ = &#123;</span><br><span class="line">    post: <span class="function"><span class="keyword">function</span> (<span class="params">url, data, success, dataType</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">this</span>.getXhr();</span><br><span class="line">        xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(xhr.readyState == <span class="number">4</span> &amp;&amp; xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> data = xhr.responseText;</span><br><span class="line">                <span class="keyword">if</span> (dataType == <span class="string">'json'</span>) &#123;</span><br><span class="line">                    data = <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">                &#125;</span><br><span class="line">                success(data);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.open(<span class="string">'post'</span>, url);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> data == <span class="string">'object'</span>) &#123;</span><br><span class="line">            data = <span class="keyword">this</span>.params(data);</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.setRequestHeader(<span class="string">'content-type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>);</span><br><span class="line">        xhr.send(data);</span><br><span class="line">    &#125;,</span><br><span class="line">    getXhr: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">            xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Msxml2.XMLHTTP'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> xhr;</span><br><span class="line">    &#125;,</span><br><span class="line">    params: <span class="function"><span class="keyword">function</span> (<span class="params">object</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> data = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> object) &#123;</span><br><span class="line">            data += key + <span class="string">'='</span> + object[key] + <span class="string">'&amp;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="2-3封装-ajax方法"><a href="#2-3封装-ajax方法" class="headerlink" title="2. 3封装$.ajax方法"></a>2. 3封装$.ajax方法</h3><p>  核心思路： 判断type的值，如果type=get,则调用<code>$.get</code>方法；如果type=post，则调用<code>$.post</code>方法</p>
<p>  $.ajax({<br>    url:<br>        data:<br>        type:  get/post<br>    dataType:<br>    success:<br>   })</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ajax: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> url = obj.url;</span><br><span class="line">        <span class="keyword">var</span> data = obj.data || <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">var</span> type = obj.type || <span class="string">'get'</span>;</span><br><span class="line">        <span class="keyword">var</span> dataType = obj.dataType || <span class="string">'text'</span>;</span><br><span class="line">        <span class="keyword">var</span> success = obj.success;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(type == <span class="string">'get'</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.get(url, data, success, dataType);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.post(url, data, success, dataType);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img alt="1541144129581" data-src="assets/1541144129581.png" class="lozad"></p>
<h2 id="12、模板引擎"><a href="#12、模板引擎" class="headerlink" title="12、模板引擎"></a>12、模板引擎</h2><h3 id="1-1-为什么要使用模板引擎"><a href="#1-1-为什么要使用模板引擎" class="headerlink" title="1.1 为什么要使用模板引擎"></a>1.1 为什么要使用模板引擎</h3><p>通过搜索用户例我们发现，要渲染到网页上的数据是使用js循环拼接字符串，再将拼接好的字符串填入tbody标签中的。</p>
<p>   这种方式可读性差，出错不容易查找。</p>
<p>   模板引擎技术就是为了解决字符串拼接问题的。<strong>模板引擎技术本质就是拼接字符串</strong></p>
<p>   传统模式有两种拼接显示字符串的方式:</p>
<ul>
<li>在后端程序中拼接好，然后以字符串形式返回</li>
<li>后端程序返回json对象，前端程序接收了之后，解析json进行拼接</li>
</ul>
<p>模板引擎方式：<br>    模板引擎属于前端程序拼接字符串<br>    提前定义好要显示格式，所有数据位置以特殊标记表示出来。模板引擎会自动分析，并将数据填写到对应的位置。</p>
<h3 id="1-2-常见模板引擎"><a href="#1-2-常见模板引擎" class="headerlink" title="1.2 常见模板引擎"></a>1.2 常见模板引擎</h3><p>☆  ArtTemplate：<a href="https://github.com/aui/artTemplate" target="_blank" rel="noopener">https://github.com/aui/artTemplate</a><br>☆  velocity.js：<a href="https://github.com/shepherdwind/velocity.js" target="_blank" rel="noopener">https://github.com/shepherdwind/velocity.js</a><br>☆  Handlebars：<a href="http://handlebarsjs.com" target="_blank" rel="noopener">http://handlebarsjs.com</a></p>
<h3 id="1-3-artTemplate快速上手"><a href="#1-3-artTemplate快速上手" class="headerlink" title="1.3 artTemplate快速上手"></a>1.3 artTemplate快速上手</h3><p>基本使用步骤:<br>  1) 使用script标签引入arttemplate库文件 (template-web.js)<br>  2) 定义标签，用来显示最终结果数据<br>  3) 定义模板和模板中所需数据。<br>      ① 定义要显示在模板中的数据，必须是 json 对象<br>      ② 使用script标签定义模板，type=”text/template”  id=”tpl”，并且使用 花括号 将所有数据位置标记出来<br>  4) 调用template函数，解析模板<br>  5) 将解析好的模板字符串填充到事先定义好的标签中(显示到网页上)</p>
<p>简单案例：拼接模板字符串 “我叫张三，今年20岁”，并输出在网页的div中</p>
<p><img alt="1540971950580" data-src="assets/1540971950580.png" class="lozad"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">关键点：</span><br><span class="line"></span><br><span class="line">1) 在定义模板时使用 script 标签， type=“text/template”  id="tpl"</span><br><span class="line">2) 定义json对象，json对象中的key一定要和模板中的 &#123;&#123;key&#125;&#125;一致</span><br><span class="line">3) 调用template函数进行解析</span><br><span class="line">    参数1: 模板的id值</span><br><span class="line">    参数2: json对象</span><br><span class="line">    返回值:解析好的字符串</span><br></pre></td></tr></table></figure>
<h3 id="1-4-循环结构-—-each"><a href="#1-4-循环结构-—-each" class="headerlink" title="1.4 循环结构 — each"></a>1.4 循环结构 — each</h3><p>  关键点:<br>1) template函数需要的参数是一个json对象，所以需要声明json对象，里面是数组</p>
<p>2) 在定义模板时使用each进行循环</p>
<p>  each结构:   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;each data value&#125;&#125;</span><br><span class="line">	输出内容</span><br><span class="line">&#123;&#123;/each&#125;&#125;</span><br><span class="line"></span><br><span class="line">注意: 使用 &#123;&#123;/each&#125;&#125; 结束循环</span><br></pre></td></tr></table></figure>
<p>  data: 要循环的数组</p>
<p>  value: 循环取出的单元值</p>
<p>  1) 引入template-web.js文件</p>
<p>  2) 定义显示最终结果的标签 — 此处是tbody</p>
<p>  <img alt="1540973136485" data-src="assets/1540973136485.png" class="lozad"></p>
<p>   3) 定义数据和模板</p>
<p>​    数据： 最初是一个数组，内部是json。 要包裹成json</p>
<p><img alt="1540973197400" data-src="assets/1540973197400.png" class="lozad"></p>
<p>   模板: 使用each来循环</p>
<p><img alt="1540973240158" data-src="assets/1540973240158.png" class="lozad"></p>
<p>​    </p>
<p>  4) 调用template函数将模板和数组组装到一起</p>
<p>  5) 将组装好的字符串显示到 tbody 中</p>
<p><img alt="1540973292807" data-src="assets/1540973292807.png" class="lozad"></p>
<h3 id="1-5-选择结构-—-if-else"><a href="#1-5-选择结构-—-if-else" class="headerlink" title="1.5 选择结构 — if else"></a>1.5 选择结构 — if else</h3><p>  关键点: 定义模板时使用 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;if  判断条件&#125;&#125;</span><br><span class="line">	程序块1</span><br><span class="line">&#123;&#123;else&#125;&#125;</span><br><span class="line">	程序块2</span><br><span class="line">&#123;&#123;/if&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><img alt="1540973621361" data-src="assets/1540973621361.png" class="lozad"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"../Xhr.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    &lt;script src=<span class="string">"./template-web.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    &lt;script type=<span class="string">"text/template"</span> id=<span class="string">"tem"</span>&gt;</span><br><span class="line">    &#123;&#123;<span class="keyword">if</span> list.length != <span class="number">0</span>&#125;&#125;</span><br><span class="line">        &#123;&#123;each list value&#125;&#125;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;value.sno&#125;&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">            &lt;td&gt;&#123;&#123;value.sname&#125;&#125;&lt;/</span>td&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;value.sage&#125;&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">            &lt;td&gt;&#123;&#123;value.sgender&#125;&#125;&lt;/</span>td&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;value.semail&#125;&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">            &lt;td&gt;&#123;&#123;value.spwd&#125;&#125;&lt;/</span>td&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;value.stel&#125;&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>tr&gt;</span><br><span class="line">        &#123;&#123;/each&#125;&#125;</span><br><span class="line">    &#123;&#123;<span class="keyword">else</span>&#125;&#125;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td colspan=<span class="string">"7"</span> align=<span class="string">"center"</span>&gt;没有相关数据&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>tr&gt;</span><br><span class="line">    &#123;&#123;/<span class="keyword">if</span>&#125;&#125;</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script type="text/</span>javascript<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        document.getElementById('btn').onclick = function () &#123;</span></span><br><span class="line"><span class="string">            var xhr = getXhr();</span></span><br><span class="line"><span class="string">            var key = document.getElementById('searchtext').value;</span></span><br><span class="line"><span class="string">            if( key.trim() == '') &#123;</span></span><br><span class="line"><span class="string">                return false;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            xhr.onreadystatechange = function () &#123;</span></span><br><span class="line"><span class="string">                if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) &#123;</span></span><br><span class="line"><span class="string">                    var arr = JSON.parse(xhr.responseText);</span></span><br><span class="line"><span class="string">                    // 遍历传回来之后json转化的数组，拼接字符串，添加进tbody中</span></span><br><span class="line"><span class="string">                    var json = &#123;"</span>list<span class="string">": arr&#125;;</span></span><br><span class="line"><span class="string">                    var str = template('tem', json);</span></span><br><span class="line"><span class="string">                    document.getElementById('tb').innerHTML = str;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            xhr.open('get', './searchdb3.php?key=' + key + '&amp;_=' + Math.random());</span></span><br><span class="line"><span class="string">            xhr.send();</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="1-6-使用模板引擎改造搜索用户名案例"><a href="#1-6-使用模板引擎改造搜索用户名案例" class="headerlink" title="1.6 使用模板引擎改造搜索用户名案例"></a>1.6 使用模板引擎改造搜索用户名案例</h3><p> 目标: 使用模板引擎来代替原来的字符串拼接</p>
<p>  1) 引入template-web.js文件</p>
<p>  2) 定义显示最终结果的标签</p>
<p><img alt="1540973879404" data-src="assets/1540973879404.png" class="lozad"></p>
<p>3) 定义 数据 和 模板</p>
<p>数据:</p>
<p><img alt="1540974239002" data-src="assets/1540974239002.png" class="lozad"></p>
<p> 模板:</p>
<p><img alt="1540974256783" data-src="assets/1540974256783.png" class="lozad"></p>
<p>​    4) 调用template函数将数据和模板组装到一起</p>
<p>​    5) 将组装好的字符串写入到tbody中</p>
<p><img alt="1540974300491" data-src="assets/1540974300491.png" class="lozad"></p>
<h3 id="1-7-选项卡案例"><a href="#1-7-选项卡案例" class="headerlink" title="1.7 选项卡案例"></a>1.7 选项卡案例</h3><p><img alt="1537151416372" data-src="assets/1.png" class="lozad"></p>
<p> 数据表:</p>
<p><img alt="1537152795378" data-src="assets/2 (3" class="lozad">.png)</p>
<p>   goods_name: 商品名称</p>
<p>   goods_price: 商品价格</p>
<p>   goods_small_logo: 商品图片</p>
<p>   goods_cateid: 商品所属类别</p>
<p>   goods_brandid: 商品所属品牌</p>
<p>   goods_tj: 是否是推荐商品  1推荐  2不推荐</p>
<p>整体思路:</p>
<p>1) index.html页面</p>
<p>   ① 在每个选项卡上都注册鼠标进入事件</p>
<p>   ② 事件函数，获取选项卡的名称，发送ajax请求，并将选项卡名称一起发送给后端php页面</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'getGoods.php'</span>,</span><br><span class="line">    data: &#123;<span class="attr">n</span>: <span class="string">"推荐商品"</span>&#125;,</span><br><span class="line">    type: <span class="string">'post'</span>,</span><br><span class="line">    dataType: <span class="string">'json'</span>,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);       </span><br><span class="line">        <span class="comment">//包装成json对象</span></span><br><span class="line">        <span class="keyword">var</span> json = &#123;<span class="string">"goodsList"</span>: data&#125;;</span><br><span class="line">        <span class="keyword">var</span> str = template(<span class="string">'tpl'</span>, json);</span><br><span class="line">        $(<span class="string">'.goodslist_wrap div'</span>).html(str).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//1. 每个选项卡注册鼠标进入事件</span></span><br><span class="line"><span class="comment">//2. 事件函数 --- 获取选项卡的文字，发送Ajax请求并将文字一起发送给后端</span></span><br><span class="line">$(<span class="string">'.goodslist h2 span'</span>).mouseenter(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = $(<span class="keyword">this</span>).text();</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: <span class="string">'getGoods.php'</span>,</span><br><span class="line">        data: &#123;<span class="attr">n</span>: name&#125;,</span><br><span class="line">        type: <span class="string">'post'</span>,</span><br><span class="line">        dataType: <span class="string">'json'</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(data); <span class="comment">//数组，内部是json对象          </span></span><br><span class="line">            <span class="comment">//包装成json对象</span></span><br><span class="line">            <span class="keyword">var</span> json = &#123;<span class="string">"goodsList"</span>: data&#125;;</span><br><span class="line">            <span class="keyword">var</span> str = template(<span class="string">'tpl'</span>, json);</span><br><span class="line">            $(<span class="string">'.goodslist_wrap div'</span>).html(str).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2) getGoods.php</p>
<p>   ① 接收选项卡名称</p>
<p>   ② 不同的选项卡名称要设置不同的sql语句</p>
<p>   ③ 执行SQL查询结果</p>
<p>   ④ 将查询结果返回给前端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">//接收选项卡名称</span><br><span class="line">$name = $_POST[&apos;n&apos;];</span><br><span class="line">//不同的选项卡名称要设置不同的sql语句</span><br><span class="line">switch ($name) &#123;</span><br><span class="line">    case &apos;推荐商品&apos;:</span><br><span class="line">        $sql = &apos;select * from sp_goods where goods_tj=1&apos;;</span><br><span class="line">        break;</span><br><span class="line">    case &apos;电脑整机&apos;:</span><br><span class="line">        $sql = &apos;select * from sp_goods where goods_id&gt;15&apos;;</span><br><span class="line">        break;</span><br><span class="line">    case &apos;电脑配件&apos;:</span><br><span class="line">        $sql = &apos;select * from sp_goods where goods_cateid=1&apos;;</span><br><span class="line">        break;</span><br><span class="line">    case &apos;办公打印&apos;:</span><br><span class="line">        $sql = &apos;select * from sp_goods where goods_brandid in (1,2)&apos;;</span><br><span class="line">        break;</span><br><span class="line">    case &apos;网络产品&apos;:</span><br><span class="line">        $sql = &apos;select * from sp_goods where goods_cateid in (2,3,4)&apos;;</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line">//链接MySQL并执行SQL查询</span><br><span class="line">$conn = mysqli_connect(&apos;localhost&apos;, &apos;root&apos;, &apos;root&apos;, &apos;study&apos;);</span><br><span class="line">mysqli_query($conn, &apos;set names utf8&apos;);</span><br><span class="line">$result_obj = mysqli_query($conn, $sql);</span><br><span class="line">//将查询结果返回给前端</span><br><span class="line">// 结果对象 ---&gt;  二维数组 ---&gt;  json  ---&gt; 返回给前端</span><br><span class="line">$arr = [];</span><br><span class="line">while ($row = mysqli_fetch_assoc($result_obj)) &#123;</span><br><span class="line">    $arr[] = $row;</span><br><span class="line">&#125;</span><br><span class="line">echo json_encode($arr);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>3) index.html页面</p>
<p>   ① 接收后端的返回数据</p>
<p>   ② 使用模板引擎将数据显示到网页上 </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"js/template-web.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;script type=<span class="string">"text/template"</span> id=<span class="string">"goodinfo"</span>&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &#123;&#123;each list value&#125;&#125;</span><br><span class="line">        &lt;li&gt;</span><br><span class="line">            &lt;dl&gt;</span><br><span class="line">            &lt;dt&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;value.goods_small_logo&#125;&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span></span><br><span class="line">            &lt;dd&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>&#123;&#123;value.goods_name&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span></span><br><span class="line">            &lt;dd&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>售价：<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>￥&#123;&#123;value.goods_price&#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span></span><br><span class="line">            &lt;<span class="regexp">/dl&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>li&gt;</span><br><span class="line">        &#123;&#123;/each&#125;&#125;</span><br><span class="line">    &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line">&lt;script src=<span class="string">"./js/data.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>代码实现:</p>
<p> 1) index.html页面</p>
<p><img alt="1540975984549" data-src="assets/1540975984549.png" class="lozad"></p>
<p>2) getGoods.php</p>
<p>   ① 接收选项卡名称</p>
<p>   ② 不同的选项卡名称要设置不同的sql语句</p>
<p>   ③ 执行SQL查询结果</p>
<p>   ④ 将查询结果返回给前端    </p>
<p><img alt="1540976472931" data-src="assets/1540976472931.png" class="lozad"></p>
<p><img alt="1540976483178" data-src="assets/1540976483178.png" class="lozad"></p>
<p>3) index.html页面</p>
<p>  ①  分页  选项卡标签结构</p>
<p>​       5个选项卡对应5个div，删除其中的4个，只留第一个div</p>
<p>​       一个div中又使用 ul + li 来显示所有商品，每个li显示一个商品</p>
<p><img alt="1540976943042" data-src="assets/1540976943042.png" class="lozad"></p>
<p>​     ②  使用模板引擎来显示数据</p>
<p>​      i. 引入template-web.js</p>
<p>​      ii. 定义显示最终结果的标签</p>
<p><img alt="1540977050371" data-src="assets/1540977050371.png" class="lozad"></p>
<p>​      iii. 定义数据 和 模板</p>
<p>​       数据: </p>
<p><img alt="1540977172463" data-src="assets/1540977172463.png" class="lozad"></p>
<p>​     模板:</p>
<p><img alt="1540977310852" data-src="assets/1540977310852.png" class="lozad"></p>
<p>iv. 调用 template 函数，将模板和数据组装到一起</p>
<p>v. 将组装好的字符串写入第二步定义好的标签中，注意：要让div一直显示</p>
<p><img alt="1540977626423" data-src="assets/1540977626423.png" class="lozad"></p>
<p>完善： 页面第一次加载时，要显示推荐商品选项卡中的数据。</p>
<p>   提前执行一次Ajax请求，并将name指定为“推荐商品”</p>
<p><img alt="1540977682214" data-src="assets/1540977682214.png" class="lozad"></p>
<h3 id="1-8-模板引擎原理简介-了解"><a href="#1-8-模板引擎原理简介-了解" class="headerlink" title="1.8 模板引擎原理简介(了解)"></a>1.8 模板引擎原理简介(了解)</h3><p> 核心原理: 使用正则替换模板引擎中的标记</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">例如: 我叫&#123;&#123;name&#125;&#125;，今年&#123;&#123;age&#125;&#125;岁</span><br><span class="line">使用正则表达式找到模板字符串中的&#123;&#123;name&#125;&#125;和&#123;&#123;age&#125;&#125;,再用真实的数据进行替换。</span><br></pre></td></tr></table></figure>
<p> 核心方法:<br>  ① reg.exec(str);<br>  reg: 正则表达式<br>  str:  字符串<br>  函数作用: 从str字符串中找到复合reg正则表达式的对象，如果没有则返回null</p>
<p>  ② str.replace(str1, str2);<br>  函数作用: 在str字符串中找到str1字符串，然后用str2字符串进行替换<br>  例如:<br>  str = “abcdefg”;<br>  str1 = “bc”;<br>  str2 = “zs”;<br>  console.log(str.replace(str1, str2)); //  azsdefg</p>
<p>  <strong>核心：掌控每一步中变量的值</strong></p>
<h2 id="13、虚拟主机配置"><a href="#13、虚拟主机配置" class="headerlink" title="13、虚拟主机配置"></a>13、虚拟主机配置</h2><h3 id="3-1-什么是虚拟主机"><a href="#3-1-什么是虚拟主机" class="headerlink" title="3.1 什么是虚拟主机"></a>3.1 什么是虚拟主机</h3><p>虚拟主机，也叫“网站空间”，就是把一台运行在互联网上的物理服务器划分成多个“虚拟”服务器，每一个虚拟服务器都能独立运行一个网站</p>
<p><img alt="1524039623401" data-src="assets/1 (4" class="lozad">.png)</p>
<h3 id="3-2-虚拟主机配置3步骤"><a href="#3-2-虚拟主机配置3步骤" class="headerlink" title="3.2 虚拟主机配置3步骤"></a>3.2 虚拟主机配置3步骤</h3><p>目标: 创建  <a href="http://www.study.com" target="_blank" rel="noopener">www.study.com</a>  和  <a href="http://www.demo.com" target="_blank" rel="noopener">www.demo.com</a> 两个网站</p>
<p>案例: 配置 <a href="http://www.study.com" target="_blank" rel="noopener">www.study.com</a>  虚拟主机</p>
<p>1) 修改apache配置文件(httpd.conf)，引入apache的虚拟主机配置文件(httpd-vhost.conf)去掉该句前的 # 号</p>
<p><img alt="1524039679721" data-src="assets/2 (4" class="lozad">.png)</p>
<p>2) 修改虚拟主机配置文件<br>d:\phpstudy\Apache\conf\extra\httpd-vhosts.conf</p>
<p><img alt="1541145892343" data-src="assets/1541145892343.png" class="lozad"></p>
<p>3) 修改hosts文件 (使用管理员权限修改)<br>c:/windows/system32/drivers/etc/hosts</p>
<p><img alt="1528962577565" data-src="assets/4 (3" class="lozad">.png)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www.demo.com</span><br></pre></td></tr></table></figure>
<p><strong>重启Apche服务器</strong></p>
<p>注意：  <a href="http://www.study.com" target="_blank" rel="noopener">www.study.com</a> 指向  d:/phpstudy/WWW/study 目录</p>
<h2 id="4、-ajax跨域"><a href="#4、-ajax跨域" class="headerlink" title="4、 ajax跨域"></a>4、 ajax跨域</h2><h3 id="4-1-什么是ajax跨域"><a href="#4-1-什么是ajax跨域" class="headerlink" title="4.1 什么是ajax跨域"></a>4.1 什么是ajax跨域</h3><p>简单来说，就是网站A去调用网站B的数据。<br>常见案例： hao123.com的天气预报。</p>
<p>但是Ajax跨域存在一个问题 — 浏览器的同源策略，该策略会阻止ajax跨域访问<br>同源策略（Same origin policy）是一种约定，它是浏览器的一种安全功能。<br>同源:  同协议，同域名，同端口；   不同源则为跨域</p>
<p><img alt="1526464487997" data-src="assets/5 (2" class="lozad">.png)</p>
<p>同源限制案例:<br><a href="http://www.study.com/origin/index.html使用ajax，请求www.demo.com/1.php文件中的数据" target="_blank" rel="noopener">www.study.com/origin/index.html使用ajax，请求www.demo.com/1.php文件中的数据</a></p>
<p>1) 创建 <a href="http://www.study.com/origin/index.html" target="_blank" rel="noopener">www.study.com/origin/index.html</a> 文件</p>
<p><img alt="1541147758919" data-src="assets/1541147758919.png" class="lozad"></p>
<p>2) 创建 <a href="http://www.demo.com/1.php" target="_blank" rel="noopener">www.demo.com/1.php</a></p>
<p><img alt="1541147773104" data-src="assets/1541147773104.png" class="lozad"></p>
<p>访问结果:</p>
<p><img alt="1541147832949" data-src="assets/1541147832949.png" class="lozad"></p>
<p>解决跨域问题有三种方式：</p>
<ul>
<li>服务器代理</li>
<li>cors （跨域资源共享）</li>
<li>jsonp</li>
</ul>
<h3 id="4-2-代理实现ajax跨域"><a href="#4-2-代理实现ajax跨域" class="headerlink" title="4.2 代理实现ajax跨域"></a>4.2 代理实现ajax跨域</h3><h4 id="file-get-contents-url"><a href="#file-get-contents-url" class="headerlink" title="file_get_contents(url)"></a>file_get_contents(url)</h4><p>核心思想:  php中有一个函数 <strong>file_get_contents</strong>。 该函数能够获取到其他网站的数据。</p>
<p>  file_get_contents(‘<a href="http://www.baidu.com/index.html&#39;)" target="_blank" rel="noopener">http://www.baidu.com/index.html&#39;)</a>;</p>
<p><img alt="1526464641537" data-src="/assets/6 (2" class="lozad">.png)</p>
<p>案例:<br><a href="http://www.study.com/proxy/index.html发送ajax请求，请求www.study.com/proxy/proxy.php文件" target="_blank" rel="noopener">www.study.com/proxy/index.html发送ajax请求，请求www.study.com/proxy/proxy.php文件</a><br>proxy.php文件使用file_get_contents函数读取<a href="http://www.demo.com/1.php文件中的内容，再返回给index.html文件中的ajax请求" target="_blank" rel="noopener">www.demo.com/1.php文件中的内容，再返回给index.html文件中的ajax请求</a></p>
<p>1)创建  <a href="http://www.study.com/proxy/index.html" target="_blank" rel="noopener">www.study.com/proxy/index.html</a></p>
<p>   在该文件中发送ajax请求，请求同服务器(<a href="http://www.study.com)下的" target="_blank" rel="noopener">www.study.com)下的</a> proxy.php文件</p>
<p><img alt="1541149250815" data-src="assets/1541149250815.png" class="lozad"></p>
<p>2)创建  <a href="http://www.study.com/proxy/proxy.php" target="_blank" rel="noopener">www.study.com/proxy/proxy.php</a> </p>
<p>  在该文件中使用 file_get_contents函数，读取远程服务器1.php中的内容</p>
<p><img alt="1541149283127" data-src="assets/1541149283127.png" class="lozad"></p>
<p>3)创建  <a href="http://www.demo.com/1.php" target="_blank" rel="noopener">www.demo.com/1.php</a></p>
<p><img alt="1541149297616" data-src="assets/1541149297616.png" class="lozad"></p>
<h3 id="4-3-cors跨域"><a href="#4-3-cors跨域" class="headerlink" title="4.3 cors跨域"></a>4.3 cors跨域</h3><h4 id="header-‘Access-Control-Allow-origin-url-’"><a href="#header-‘Access-Control-Allow-origin-url-’" class="headerlink" title="header(‘Access-Control-Allow-origin: url || *’)"></a>header(‘Access-Control-Allow-origin: url || *’)</h4><p> cors: 跨域资源共享。<br> <strong>同源策略是浏览器的策略</strong>。但是如果服务器允许其他网站的页面进行跨域访问，那么浏览器就不会对返回的数据进行限制了。</p>
<p><strong>核心方法: 在服务器端(PHP文件中)声明不用进行同源限制</strong></p>
<p>如果设置为 <em> 则是所有外部网站都可以获取数据<br>**header(‘Access-Control-Allow-origin: </em>‘);** </p>
<p>只允许<a href="http://www.study.com网站访问并获取数据" target="_blank" rel="noopener">www.study.com网站访问并获取数据</a><br>header(‘Access-Control-Allow-origin: <a href="http://www.study.com&#39;)" target="_blank" rel="noopener">http://www.study.com&#39;)</a>; </p>
<p>案例:<br><a href="http://www.study.com/cors/index.html发送ajax请求，请求www.demo.com/cors.php文件的数据" target="_blank" rel="noopener">www.study.com/cors/index.html发送ajax请求，请求www.demo.com/cors.php文件的数据</a><br>1)创建 <a href="http://www.study.com/cors/index.html文件" target="_blank" rel="noopener">www.study.com/cors/index.html文件</a> 发送ajax请求</p>
<p><img alt="1541149919809" data-src="assets/1541149919809.png" class="lozad"></p>
<p>2)创建 <a href="http://www.demo.com/cors.php" target="_blank" rel="noopener">www.demo.com/cors.php</a></p>
<p><img alt="1541149943948" data-src="assets/1541149943948.png" class="lozad"></p>
<h3 id="4-4-jsonp跨域"><a href="#4-4-jsonp跨域" class="headerlink" title="4.4 jsonp跨域"></a>4.4 jsonp跨域</h3><p>JSONP(JSON with Padding) : 是一种解决ajax跨域访问的方案。</p>
<p>核心思想:<br>   浏览器虽然有同源策略，但是 src 和 href 两个属性却可以跨域访问。 可以利用这一“漏洞”来请求另一个网站的页面。</p>
<p>案例:<br><a href="http://www.study.com/jsonp/index.html文件中通过script标签的src属性，跨域访问www.demo.com/jsonp.php文件中的数据" target="_blank" rel="noopener">www.study.com/jsonp/index.html文件中通过script标签的src属性，跨域访问www.demo.com/jsonp.php文件中的数据</a></p>
<p>1) 创建 <a href="http://www.study.com/jsonp/index.html" target="_blank" rel="noopener">www.study.com/jsonp/index.html</a> ,使用 script标签引入了  <a href="http://www.demo.com/jsonp.php文件" target="_blank" rel="noopener">www.demo.com/jsonp.php文件</a></p>
<p><img alt="1541150640090" data-src="assets/1541150640090.png" class="lozad"></p>
<p>2) 创建 <a href="http://www.demo.com/jsonp.php文件" target="_blank" rel="noopener">www.demo.com/jsonp.php文件</a> 输出个 aaa()</p>
<p><img alt="1541150685770" data-src="assets/1541150685770.png" class="lozad"></p>
<p>访问结果:</p>
<p><img alt="1541150734000" data-src="assets/1541150734000.png" class="lozad"></p>
<p><img alt="1541150752451" data-src="assets/1541150752451.png" class="lozad"></p>
<p>此时, </p>
<p><img alt="1541150837439" data-src="assets/1541150837439.png" class="lozad"></p>
<p>3) 在<a href="http://www.study.com/jsonp/index.html文件中定义" target="_blank" rel="noopener">www.study.com/jsonp/index.html文件中定义</a> aaa() 函数</p>
<p><img alt="1541150953496" data-src="assets/1541150953496.png" class="lozad"></p>
<p>4) 后端 <a href="http://www.demo.com/jsonp.php" target="_blank" rel="noopener">www.demo.com/jsonp.php</a> 可以在输出函数名时，将要返回给前端的数据拼接到形参的位置</p>
<p><img alt="1541151080234" data-src="assets/1541151080234.png" class="lozad"></p>
<p>同时，在<a href="http://www.study.com/jsonp/index.html" target="_blank" rel="noopener">www.study.com/jsonp/index.html</a> 文件中，定义aaa函数时增加形参</p>
<p><img alt="1541151167299" data-src="assets/1541151167299.png" class="lozad"></p>
<p><a href="http://www.study.com下的index.html" target="_blank" rel="noopener">www.study.com下的index.html</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="comment">// 在本页面中定义一个函数接收echo回来的函数字符串，参数是数据，就可以进行数据传输</span></span><br><span class="line">function aaa(data) &#123;</span><br><span class="line">    console.log(data)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"><span class="comment">// script标签中会有php页面echo回来的值</span></span><br><span class="line">&lt;script type="text/javascript" src="http://www.demo.com/jsonp.php"&gt;echo&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><a href="http://www.demo.com下的jsonp.php文件" target="_blank" rel="noopener">www.demo.com下的jsonp.php文件</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'content-type: text/html; charset=utf-8'</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'document.write("这里是demo")'</span>;  <span class="comment">// index页面会打印这里是demo</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"aaa('这里的山路十八弯！')"</span>; <span class="comment">// 这句话作为实参传递给index页面中的函数形参进行调用</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="4-5-ajax方法跨域操作-—-jsonp方式"><a href="#4-5-ajax方法跨域操作-—-jsonp方式" class="headerlink" title="4.5 $.ajax方法跨域操作 — jsonp方式"></a>4.5 $.ajax方法跨域操作 — jsonp方式</h3><p><code>$.post  $.get $.ajax都能发送跨域请求。但是，$.post和$.get是要依靠cors方式的，只有$.ajax能使用jsonp方式</code></p>
<p>核心:<br>    必须设置请求类型为get  ===》  type: ‘get’<br>    必须设置dataType为jsonp ===》 dataType: ‘jsonp’<br>    必须额外设置一个jsonp参数，该参数值可以是任何英文字符串，常用callback。</p>
<p> <strong>jsonp: ‘callback’</strong><br>           <strong>该参数会产生一个随机字符串</strong><br>           <strong>前端使用该字符串创建一个函数</strong><br>           <strong>后端接收该字符串作为返回函数的名称</strong></p>
<p>示例:</p>
<p>1) 使用jsonp发送跨域请求</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'http://www.study.com/test/3.php'</span>,</span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    type: <span class="string">'get'</span>,   </span><br><span class="line">    dataType: <span class="string">'jsonp'</span>,   </span><br><span class="line">    jsonp: <span class="string">'callback'</span>,  <span class="comment">//解决前后端函数名统一的问题   </span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        alert(data);  <span class="comment">// 输出参数是普通字符串的结果</span></span><br><span class="line">        alert(data.name);   <span class="comment">// 输出参数是对象字符串的结果</span></span><br><span class="line">        alert(data[index])   <span class="comment">// 输出参数是数组字符串的结构 </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2) 后端拼接函数字符串</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">// 函数名</span></span><br><span class="line">$callback = $_GET[<span class="string">'callback'</span>];</span><br><span class="line">$str = <span class="string">"$.ajax---&gt;jsonp"</span>;</span><br><span class="line"><span class="keyword">echo</span> $callback . <span class="string">"('$str')"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">格式：</span><br><span class="line">$func = $_GET[<span class="string">'callback'</span>]; <span class="comment">//接收函数名</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"$func(data)"</span>;  <span class="comment">//data就是要返回给前端的数据</span></span><br><span class="line">例子：</span><br><span class="line">$result = $_GET[<span class="string">'callback'</span>];</span><br><span class="line">传对象</span><br><span class="line">$str = <span class="string">"&#123;'name': 'zs', 'age': 18&#125;"</span>; </span><br><span class="line">传数组</span><br><span class="line">$str = <span class="string">"['zs', 18]"</span>;  </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"$result($str)"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img alt="1541402052965" data-src="assets\1541402052965.png" class="lozad"></p>
<p>案例:<br><a href="http://www.study.com/jsonp/ajax.html跨域访问www.demo.com/jsonp_jq.php文件中的内容" target="_blank" rel="noopener">www.study.com/jsonp/ajax.html跨域访问www.demo.com/jsonp_jq.php文件中的内容</a></p>
<p>1)　创建 <a href="http://www.study.com/jsonp/ajax.html" target="_blank" rel="noopener">www.study.com/jsonp/ajax.html</a> 发送ajax请求</p>
<p><img alt="1541152689579" data-src="assets/1541152689579.png" class="lozad"></p>
<p>2)　创建<a href="http://www.demo.com/jsonp_jq.php" target="_blank" rel="noopener">www.demo.com/jsonp_jq.php</a> 返回数据</p>
<p><img alt="1541152712444" data-src="assets/1541152712444.png" class="lozad"></p>
<p>关键点: callback会向后端发送一个以 jQuery开头的随机字符串，该字符串就是函数名</p>
<p><img alt="1541152512515" data-src="assets/1541152512515.png" class="lozad"></p>
<p>总结:</p>
<p>前端: (三个配置项)</p>
<p>​      type：’get’</p>
<p>​      dataType：’jsonp’</p>
<p>​      jsonp：’callbakc’    </p>
<p>后端：（核心两步）</p>
<h3 id="4-6-调用网上接口-—-天气预报"><a href="#4-6-调用网上接口-—-天气预报" class="headerlink" title="4.6 调用网上接口 — 天气预报"></a>4.6 调用网上接口 — 天气预报</h3><p><a href="http://t.weather.sojson.com/api/weather/city/101030100" target="_blank" rel="noopener">http://t.weather.sojson.com/api/weather/city/101030100</a>   （天津的城市信息）</p>
<p><img alt="1531067693123" data-src="assets/7.png" class="lozad"></p>
<p>api说明:</p>
<p><img alt="1531148039369" data-src="assets/8.png" class="lozad"></p>
<p>注册，购买后可在“我的api”中看到</p>
<p><img alt="1531148099461" data-src="assets/9.png" class="lozad"></p>
<p><img alt="1531148202923" data-src="assets/10.png" class="lozad"></p>
<p>1） 发送ajax请求</p>
<p><img alt="1531217810411" data-src="assets/1531217810411.png" class="lozad"></p>
<p>2) 将取得数据筛选后显示到网页上</p>
<p><img alt="1531217839295" data-src="assets/1531217839295.png" class="lozad"></p>
<p><a href="http://t.weather.sojson.com/api/weather/city/101030100" target="_blank" rel="noopener">http://t.weather.sojson.com/api/weather/city/101030100</a>   （天津的城市信息）</p>
<p>1) 使用代理方式请求天气预报的接口地址【经过不断的常会cors和jsonp两个方法之后，不行】</p>
<p><img alt="1541154221123" data-src="assets/1541154221123.png" class="lozad"></p>
<p>getWeather.php 中使用 get_file_contents获取远程接口提供的数据</p>
<p><img alt="1541154266363" data-src="assets/1541154266363.png" class="lozad"></p>
<p>访问结果:</p>
<p><img alt="1541154290918" data-src="assets/1541154290918.png" class="lozad"></p>
<p>2） 以表格形式将forecast中的数据显示出来 — 模板引擎</p>
<p>  ① 引入 template-web.js</p>
<p>  ② 定义显示最终结果的标签</p>
<p><img alt="1541155027325" data-src="assets/1541155027325.png" class="lozad"></p>
<p>  ③ 定义数据和模板字符串</p>
<p><img alt="1541155061660" data-src="assets/1541155061660.png" class="lozad"></p>
<p> ④ 调用 template 方法时，注意传入的对象</p>
<p><img alt="1541155093981" data-src="assets/1541155093981.png" class="lozad"></p>
<p>   <strong>重点</strong>： 参数2和each中的参数1配合 能找到数组</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">雪海の无涯</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://wuguolong.com/2019/10/24/Ajax笔记/Ajax基础笔记/">http://wuguolong.com/2019/10/24/Ajax笔记/Ajax基础笔记/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://wuguolong.com">云海雪原</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Ajax/">Ajax    </a></div><div class="post_share"><div class="social-share" data-image="https://s2.ax1x.com/2019/10/24/KUV0KS.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2019/10/24/Git使用笔记/"><img class="prev_cover lozad" data-src="https://s2.ax1x.com/2019/10/24/KUV0KS.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>git介绍</span></div></a></div><div class="next-post pull-right"><a href="/2019/05/26/hexo搭建播客/"><img class="next_cover lozad" data-src="https://s2.ax1x.com/2019/10/24/KUV0KS.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Hexo 创建博客</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'QOWvG4y52wLGETHWOBorduMj-gzGzoHsz',
  appKey:'92vutIllr4PBQhRIlGCkGJPU',
  placeholder:'Please leave your footprints',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></div><footer><div id="footer"><div class="copyright">&copy;2018 - 2020 By 雪海の无涯</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="nightshift fa fa-moon-o" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script color="0,0,255" opacity="0.7" zindex="-1" count="99" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/js/canvas-nest.js"></script><script src="/js/baidupush.js"> </script><script src="/js/activate-power-mode.js"></script><script>POWERMODE.colorful = true; // make power mode colorful
POWERMODE.shake = true; // turn off shake
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script></body></html>